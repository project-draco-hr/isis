{
  final String serializedEvent=eventSerializer.serialize(metadata,payload).toString();
  final PublishedEventJdo publishedEvent=newTransientInstance(PublishedEventJdo.class);
  if (this.serializedForm == SerializedForm.ZIPPED) {
    final byte[] zippedBytes=asZippedBytes(serializedEvent);
    publishedEvent.setSerializedFormZipped(zippedBytes);
  }
 else {
    publishedEvent.setSerializedFormClob(serializedEvent);
  }
  publishedEvent.setTransactionId(metadata.getTransactionId());
  publishedEvent.setSequence(metadata.getSequence());
  publishedEvent.setEventType(metadata.getEventType());
  publishedEvent.setTimestamp(metadata.getJavaSqlTimestamp());
  publishedEvent.setUser(metadata.getUser());
  publishedEvent.setTitle(metadata.getTitle());
  publishedEvent.setTargetClass(metadata.getTargetClass());
  publishedEvent.setTarget(metadata.getTarget());
  publishedEvent.setTargetAction(metadata.getTargetAction());
  publishedEvent.setMemberIdentifier(metadata.getActionIdentifier());
  persist(publishedEvent);
}
