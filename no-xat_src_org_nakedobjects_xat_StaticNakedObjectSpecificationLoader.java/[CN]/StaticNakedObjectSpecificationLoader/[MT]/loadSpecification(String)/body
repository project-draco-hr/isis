{
  if (className == null) {
    throw new NullPointerException("No class name specified");
  }
  if (classes.containsKey(className)) {
    return (NakedObjectSpecification)classes.get(className);
  }
 else {
    Reflector reflector;
    try {
      Class cls=Class.forName(className);
      if (InternalNakedObject.class.isAssignableFrom(cls) || cls.getName().startsWith("java.")) {
        reflector=new InternalReflector(className);
      }
 else {
        ReflectorFactory reflectorFactory=NakedObjects.getReflectorFactory();
        if (reflectorFactory == null) {
          throw new NakedObjectRuntimeException("No reflector factory has be set up");
        }
        reflector=reflectorFactory.createReflector(className);
      }
      LOG.info("initialising specification for " + className);
      NakedObjectSpecificationImpl spec=new NakedObjectSpecificationImpl();
      classes.put(className,spec);
      spec.reflect(className,reflector);
      return spec;
    }
 catch (    ClassNotFoundException e) {
      LOG.debug("non class " + className);
      NakedObjectSpecificationImpl spec=new NakedObjectSpecificationImpl();
      spec.nonReflect(className);
      classes.put(className,spec);
      return spec;
    }
  }
}
