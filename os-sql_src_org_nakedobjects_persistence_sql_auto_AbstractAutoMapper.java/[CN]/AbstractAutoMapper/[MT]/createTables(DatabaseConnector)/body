{
  if (!connection.hasTable(table)) {
    StringBuffer columns=new StringBuffer();
    for (int f=0; f < fields.length; f++) {
      FieldSpecification field=fields[f];
      String type;
      if (field instanceof ValueFieldSpecification) {
        ValueMapperLookup mappers=ValueMapperLookup.getInstance();
        ValueMapper mapper=mappers.mapperFor(fields[f].getSpecification());
        if (mapper == null) {
          throw new SqlObjectStoreException("No type specified for " + fields[f].getSpecification().getFullName());
        }
        type=mapper.columnType();
      }
 else       if (field instanceof OneToOneAssociationSpecification) {
        type="INT";
      }
 else {
        throw new SqlObjectStoreException("Can't map field to column: " + field);
      }
      columns.append(columnNames[f]);
      columns.append(" ");
      columns.append(type);
      columns.append(",");
    }
    columns.append(idColumn + " int");
    connection.update("create table " + table + " ("+ columns+ ")");
  }
  for (int i=0; collectionMappers != null && i < collectionMappers.length; i++) {
    if (collectionMappers[i].needsTables(connection)) {
      collectionMappers[i].createTables(connection);
    }
  }
}
