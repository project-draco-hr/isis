{
  boolean noneInProgress=false;
  if (getTransaction() == null || getTransaction().getState().isComplete()) {
    noneInProgress=true;
    final List<Object> registeredServices=servicesInjector.getRegisteredServices();
    startRequestOnRequestScopedServices(registeredServices);
    createCommandIfConfigured();
    initOtherApplibServicesIfConfigured(registeredServices);
    IsisTransaction isisTransaction=createTransaction();
    transactionLevel=0;
    transactionalResource.startTransaction();
    startTransactionOnCommandIfConfigured(isisTransaction.getTransactionId());
  }
  transactionLevel++;
  if (LOG.isDebugEnabled()) {
    LOG.debug("startTransaction: level " + (transactionLevel - 1) + "->"+ (transactionLevel)+ (noneInProgress ? " (no transaction in progress or was previously completed; transaction created)" : ""));
  }
}
