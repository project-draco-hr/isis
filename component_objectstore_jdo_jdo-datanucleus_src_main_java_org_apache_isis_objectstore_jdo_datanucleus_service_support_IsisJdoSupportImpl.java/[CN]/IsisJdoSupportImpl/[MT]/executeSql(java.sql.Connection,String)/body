{
  final List<Map<String,Object>> rows=Lists.newArrayList();
  Statement statement=null;
  try {
    statement=connection.createStatement();
    final ResultSet rs=statement.executeQuery(sql);
    final ResultSetMetaData rsmd=rs.getMetaData();
    while (rs.next()) {
      Map<String,Object> row=Maps.newLinkedHashMap();
      final int columnCount=rsmd.getColumnCount();
      for (int i=0; i < columnCount; i++) {
        final Object val=rs.getObject(i + 1);
        row.put(rsmd.getColumnName(i + 1),val);
      }
      rows.add(row);
    }
  }
 catch (  SQLException ex) {
    throw new ObjectPersistenceException("Failed to executeSql: " + sql,ex);
  }
 finally {
    closeSafely(statement);
  }
  return rows;
}
