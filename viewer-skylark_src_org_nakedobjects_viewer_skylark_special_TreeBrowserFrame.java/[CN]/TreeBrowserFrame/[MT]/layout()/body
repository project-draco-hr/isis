{
  if (invalidLayout) {
    left.layout();
    if (right != null) {
      right.layout();
    }
    Bounds workspaceLimit=getWorkspace().getBounds();
    workspaceLimit.contract(getView().getPadding());
    Size rightPanelRequiredSize=(right == null) ? new Size() : right.getRequiredSize();
    Size leftPanelRequiredSize=left.getRequiredSize();
    Bounds subviews=new Bounds(leftPanelRequiredSize);
    subviews.extendWidth(rightPanelRequiredSize.getWidth());
    subviews.ensureHeight(rightPanelRequiredSize.getHeight());
    int maxHeight=Math.min(subviews.getHeight(),workspaceLimit.getHeight());
    subviews.setHeight(maxHeight);
    if (workspaceLimit.limitBounds(subviews)) {
      if (right != null) {
        rightPanelRequiredSize.setWidth(workspaceLimit.getWidth() - leftPanelRequiredSize.getWidth());
      }
    }
    leftPanelRequiredSize.setHeight(subviews.getHeight());
    left.setSize(leftPanelRequiredSize);
    left.layout();
    if (right != null) {
      right.setLocation(new Location(rightViewOffet(),0));
      rightPanelRequiredSize.setHeight(subviews.getHeight());
      right.setSize(rightPanelRequiredSize);
      right.layout();
    }
    invalidLayout=false;
  }
}
