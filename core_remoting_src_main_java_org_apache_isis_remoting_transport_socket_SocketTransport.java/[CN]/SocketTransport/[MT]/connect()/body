{
  if (socket != null) {
    return;
  }
  try {
    socket=new Socket(host,port);
    inputStream=socket.getInputStream();
    outputStream=socket.getOutputStream();
    if (isProfiling()) {
      inputStream=new ProfilingInputStream(inputStream);
      outputStream=new ProfilingOutputStream(outputStream);
    }
    if (LOG.isDebugEnabled()) {
      LOG.debug("connection established " + socket);
    }
  }
 catch (  final MalformedURLException e) {
    throw new ConnectionException("Connection failure",e);
  }
catch (  final UnknownHostException e) {
    throw new ConnectionException("Connection failure",e);
  }
catch (  final ConnectException e) {
    throw new ConnectionException("Failed to connect to " + host + "/"+ port,e);
  }
catch (  final IOException e) {
    throw new ConnectionException("Connection failure",e);
  }
}
