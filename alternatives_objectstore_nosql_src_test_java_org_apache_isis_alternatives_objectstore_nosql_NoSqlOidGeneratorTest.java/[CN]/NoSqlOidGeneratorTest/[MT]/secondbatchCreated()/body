{
  oidGenerator.convertTransientToPersistentOid(oid);
  oidGenerator.convertTransientToPersistentOid(oid=oidGenerator.createTransientOid(null));
  oidGenerator.convertTransientToPersistentOid(oid=oidGenerator.createTransientOid(null));
  assertEquals(3,oid.getSerialNo());
  oidGenerator.convertTransientToPersistentOid(oid=oidGenerator.createTransientOid(null));
  assertEquals(4,oid.getSerialNo());
  context.checking(new Expectations(){
{
      one(db).nextSerialNumberBatch(4);
      will(returnValue(5L));
    }
  }
);
  oidGenerator.convertTransientToPersistentOid(oid=oidGenerator.createTransientOid(null));
  assertFalse(oid.isTransient());
  assertEquals(5,oid.getSerialNo());
  context.assertIsSatisfied();
}
