{
  final int lastDot=remaining.lastIndexOf('.');
  final String candidate=remaining.substring(lastDot + 1).toUpperCase() + "_" + lastCandidate;
  if (tableNames.containsKey(candidate)) {
    if (lastDot == -1) {
      throw new IsisException("Cannot create unique table name for" + persistentClass.getName());
    }
    assignTableName(tableNames,persistentClass,remaining.substring(0,lastDot),candidate);
  }
 else {
    tableNames.put(candidate,persistentClass);
    persistentClass.setTableName(candidate);
  }
}
