{
  DummyNakedObjectSpecification fieldSpec=new DummyNakedObjectSpecification();
  DummyNakedObjectSpecification objectSpec=new DummyNakedObjectSpecification();
  DummyOneToOnePeer peerOne=new DummyOneToOnePeer();
  peerOne.setupVisible(true);
  OneToOneAssociation field1=new OneToOneAssociationImpl("cls","one",fieldSpec,peerOne);
  OneToOneAssociation field2=new OneToOneAssociationImpl("cls","two",fieldSpec,peerOne);
  objectSpec.setupFields(new NakedObjectField[]{field1,field2});
  object.setupSpecification(objectSpec);
  DummyNakedObject fieldObject1=new DummyNakedObject();
  fieldObject1.setupResolveState(ResolveState.GHOST);
  object.setupFieldValue("one",fieldObject1);
  DummyNakedObject fieldObject2=new DummyNakedObject();
  object.setupFieldValue("two",fieldObject2);
  target.expected.addExpectedMethod("fieldAccessorFor");
  target.expected.addExpectedParameter("one");
  target.setupField(field1);
  factory.calls.addExpectedMethod("createTestObject");
  factory.calls.addExpectedParameter(fieldObject1);
  factory.calls.addExpectedParameter("cache");
  factory.calls.addExpectedMethod("createTestObject");
  factory.calls.addExpectedParameter(fieldObject2);
  factory.calls.addExpectedParameter("cache");
  MockTestObject fieldTestObject=new MockTestObject();
  factory.setupObject(fieldTestObject);
  TestNaked field=target.getField("one");
  assertEquals(fieldTestObject,field);
  target.verify();
  factory.verify();
}
