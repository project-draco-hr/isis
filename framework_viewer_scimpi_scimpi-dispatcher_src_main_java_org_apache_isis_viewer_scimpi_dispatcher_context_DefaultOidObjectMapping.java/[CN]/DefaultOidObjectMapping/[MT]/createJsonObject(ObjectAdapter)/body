{
  final JSONObject data=new JSONObject();
  final Oid oid=adapter.getOid();
  data.put("_oidType",oid.getClass().getName());
  if (oid instanceof OidWithSpecification) {
    OidWithSpecification ows=(OidWithSpecification)oid;
    data.put("_class",ows.getClassName());
    data.put("_id",enString(ows));
    return data;
  }
  final ObjectSpecification objectSpec=adapter.getSpecification();
  data.put("_class",objectSpec.getFullIdentifier());
  String encodedOid;
  if (oid instanceof AggregatedOid) {
    final AggregatedOid aoid=(AggregatedOid)oid;
    final Oid parentOid=aoid.getParentOid();
    final String aggregatedId=aoid.getId();
    encodedOid=enString(parentOid,aggregatedId);
  }
 else   if (oid instanceof SerialOid) {
    encodedOid=Long.toString(((SerialOid)oid).getSerialNo(),16);
  }
 else {
    throw new ScimpiException("Unsupported OID type " + oid);
  }
  data.put("_id",encodedOid);
  return data;
}
