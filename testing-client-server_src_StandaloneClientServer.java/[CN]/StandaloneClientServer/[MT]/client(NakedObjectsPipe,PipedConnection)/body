{
  PropertiesConfiguration configuration=new PropertiesConfiguration(new PropertiesFileLoader(CLIENT_CONFIG,true));
  nakedObjects.setConfiguration(configuration);
  PipedClient client=new PipedClient();
  client.setConnection(connection);
  Distribution clientLogger=client;
  Date.setClock(new SystemClock());
  JavaBusinessObjectContainer container=new JavaBusinessObjectContainer();
  JavaObjectFactory objectFactory=new JavaObjectFactory();
  objectFactory.setContainer(container);
  JavaDataFactory objectDataFactory=new JavaDataFactory();
  ProxyPersistor proxyObjectManager=new ProxyPersistor();
  proxyObjectManager.setConnection(clientLogger);
  proxyObjectManager.setObjectDataFactory(objectDataFactory);
  NakedObjectPersistor objectManager=proxyObjectManager;
  nakedObjects.setObjectPersistor(objectManager);
  ObjectLoaderImpl objectLoader=new ObjectLoaderImpl();
  objectLoader.setPojoAdapterMap(new PojoAdapterHashMap());
  objectLoader.setAdapterFactory(new JavaAdapterFactory());
  objectLoader.setObjectFactory(objectFactory);
  objectLoader.setIdentityAdapterMap(new IdentityAdapterHashMap());
  nakedObjects.setObjectLoader(objectLoader);
  ProxyPeerFactory reflectionFactory=new ProxyPeerFactory();
  reflectionFactory.setConnection(clientLogger);
  reflectionFactory.setObjectDataFactory(objectDataFactory);
  ReflectionPeerFactory[] factories=new ReflectionPeerFactory[]{reflectionFactory};
  JavaSpecificationLoader specificationLoader=new JavaSpecificationLoader();
  specificationLoader.setReflectionPeerFactories(factories);
  nakedObjects.setSpecificationLoader(specificationLoader);
  nakedObjects.init();
  ViewUpdateNotifier updateNotifier=new ViewUpdateNotifier();
  proxyObjectManager.setUpdateNotifier(updateNotifier);
  SkylarkViewer skylark=new SkylarkViewer();
  skylark.setUpdateNotifier(updateNotifier);
  skylark.setShutdownListener(new ObjectViewingMechanismListener(){
    public void viewerClosing(){
      System.exit(0);
    }
  }
);
  skylark.setApplication(new Context());
  skylark.setExploration(true);
  skylark.init();
}
