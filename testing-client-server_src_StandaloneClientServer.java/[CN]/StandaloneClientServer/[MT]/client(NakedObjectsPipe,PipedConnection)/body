{
  Configuration configuration=new Configuration(new ConfigurationPropertiesLoader(CLIENT_CONFIG,true));
  nakedObjects.setConfiguration(configuration);
  PipedClient client=new PipedClient();
  client.setConnection(connection);
  DistributionLogger clientLogger=new DistributionLogger(client,"client-connection.log");
  Date.setClock(new SystemClock());
  JavaBusinessObjectContainer container=new JavaBusinessObjectContainer();
  JavaObjectFactory objectFactory=new JavaObjectFactory();
  objectFactory.setContainer(container);
  JavaObjectDataFactory objectDataFactory=new JavaObjectDataFactory();
  ProxyObjectManager proxyObjectManager=new ProxyObjectManager();
  proxyObjectManager.setConnection(clientLogger);
  proxyObjectManager.setObjectDataFactory(objectDataFactory);
  NakedObjectManager objectManager=new ObjectManagerLogger(proxyObjectManager,"client-manager.log");
  nakedObjects.setObjectManager(objectManager);
  new NakedObjectSpecificationLoaderImpl();
  ProxyReflectionFactory reflectionFactory=new ProxyReflectionFactory();
  reflectionFactory.setConnection(clientLogger);
  reflectionFactory.setObjectDataFactory(objectDataFactory);
  JavaReflectorFactory reflectorFactory=new JavaReflectorFactory();
  ObjectLoaderImpl objectLoader=new ObjectLoaderImpl();
  objectLoader.setPojoAdapterMap(new PojoAdapterHashImpl());
  objectLoader.setObjectFactory(objectFactory);
  objectLoader.setIdentityAdapterMap(new IdentityAdapterMapImpl());
  nakedObjects.setObjectLoader(objectLoader);
  nakedObjects.setReflectionFactory(reflectionFactory);
  NakedObjectSpecificationLoaderImpl specificationLoader=new NakedObjectSpecificationLoaderImpl();
  nakedObjects.setReflectorFactory(reflectorFactory);
  nakedObjects.setSpecificationLoader(specificationLoader);
  nakedObjects.init();
  ViewUpdateNotifier updateNotifier=new ViewUpdateNotifier();
  proxyObjectManager.setUpdateNotifier(updateNotifier);
  client.setUpdateNotifier(updateNotifier);
  SkylarkViewer skylark=new SkylarkViewer();
  skylark.setUpdateNotifier(updateNotifier);
  skylark.setShutdownListener(new ObjectViewingMechanismListener(){
    public void viewerClosing(){
      System.exit(0);
    }
  }
);
  skylark.setApplication(new Context());
  skylark.setExploration(true);
  skylark.init();
}
