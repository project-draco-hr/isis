{
  Configuration configuration=new Configuration(new ConfigurationPropertiesLoader(CLIENT_CONFIG,true));
  nakedObjects.setConfiguration(configuration);
  PipedClient client=new PipedClient();
  client.setConnection(connection);
  Distribution clientLogger=client;
  Date.setClock(new SystemClock());
  JavaBusinessObjectContainer container=new JavaBusinessObjectContainer();
  JavaObjectFactory objectFactory=new JavaObjectFactory();
  objectFactory.setContainer(container);
  JavaDataFactory objectDataFactory=new JavaDataFactory();
  ProxyObjectManager proxyObjectManager=new ProxyObjectManager();
  proxyObjectManager.setConnection(clientLogger);
  proxyObjectManager.setObjectDataFactory(objectDataFactory);
  NakedObjectManager objectManager=proxyObjectManager;
  nakedObjects.setObjectManager(objectManager);
  ProxyReflectionFactory reflectionFactory=new ProxyReflectionFactory();
  reflectionFactory.setConnection(clientLogger);
  reflectionFactory.setObjectDataFactory(objectDataFactory);
  ObjectLoaderImpl objectLoader=new ObjectLoaderImpl();
  objectLoader.setPojoAdapterMap(new PojoAdapterHashMap());
  objectLoader.setAdapterFactory(new JavaAdapterFactory());
  objectLoader.setObjectFactory(objectFactory);
  objectLoader.setIdentityAdapterMap(new IdentityAdapterHashMap());
  nakedObjects.setObjectLoader(objectLoader);
  nakedObjects.setReflectionFactory(reflectionFactory);
  nakedObjects.setSpecificationLoader(new JavaSpecificationLoader());
  nakedObjects.init();
  ViewUpdateNotifier updateNotifier=new ViewUpdateNotifier();
  proxyObjectManager.setUpdateNotifier(updateNotifier);
  SkylarkViewer skylark=new SkylarkViewer();
  skylark.setUpdateNotifier(updateNotifier);
  skylark.setShutdownListener(new ObjectViewingMechanismListener(){
    public void viewerClosing(){
      System.exit(0);
    }
  }
);
  skylark.setApplication(new Context());
  skylark.setExploration(true);
  skylark.init();
}
