{
  try {
    final OutputStream whiteListOutputResource=resourceStreamSource.writeResource(whiteListResourceName);
    if (whiteListOutputResource == null) {
      if (!printedWarning) {
        LOG.warn("unable to write out authorisation details");
        printedWarning=true;
      }
      return;
    }
    if (LOG.isDebugEnabled() && !printedDebug) {
      LOG.debug("writing authorisation details to " + whiteListResourceName);
      printedDebug=true;
    }
    final OutputStreamWriter fileWriter=new OutputStreamWriter(whiteListOutputResource);
    final BufferedWriter buffWriter=new BufferedWriter(fileWriter);
    final Set<Entry<String,List<String>>> entrySet=whiteListMap.entrySet();
    for (int i=0; i < entrySet.size(); i++) {
      final Map.Entry<String,List<String>> entry=(Map.Entry<String,List<String>>)entrySet.toArray()[i];
      final StringBuffer buff=new StringBuffer();
      buff.append(entry.getKey()).append(":");
      final List<String> roles=entry.getValue();
      for (int j=0; j < roles.size(); j++) {
        buff.append(roles.get(j));
        if (j < roles.size() - 1) {
          buff.append("|");
        }
      }
      buffWriter.write(buff.toString());
      buffWriter.newLine();
    }
    buffWriter.flush();
    buffWriter.close();
  }
 catch (  final IOException e) {
    throw new IsisException(e);
  }
}
