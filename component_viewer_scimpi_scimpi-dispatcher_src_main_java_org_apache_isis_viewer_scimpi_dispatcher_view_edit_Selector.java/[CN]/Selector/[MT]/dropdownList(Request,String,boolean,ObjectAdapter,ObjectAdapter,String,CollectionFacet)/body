{
  final RequestContext context=request.getContext();
  final Iterator<ObjectAdapter> iterator=facet.iterator(collection);
  final StringBuffer buffer=new StringBuffer();
  size=size == null ? "" : " size =\"" + size + "\"";
  buffer.append("<select name=\"" + field + "\""+ size+ " >\n");
  if (allowNotSet) {
    buffer.append("  <option value=\"null\"></option>\n");
  }
  while (iterator.hasNext()) {
    final ObjectAdapter element=iterator.next();
    final String elementId=context.mapObject(element,Scope.INTERACTION);
    final String title=element.titleString();
    final String checked=element == selectedItem ? "selected=\"selected\"" : "";
    buffer.append("  <option value=\"" + elementId + "\""+ checked+ ">"+ title+ "</option>\n");
  }
  buffer.append("</select>\n");
  return buffer.toString();
}
