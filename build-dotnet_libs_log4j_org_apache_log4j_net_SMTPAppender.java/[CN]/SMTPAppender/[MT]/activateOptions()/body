{
  Properties props=new Properties(System.getProperties());
  if (smtpHost != null)   props.put("mail.smtp.host",smtpHost);
  Session session=Session.getInstance(props,null);
  msg=new MimeMessage(session);
  try {
    if (from != null)     msg.setFrom(getAddress(from));
 else     msg.setFrom();
    msg.setRecipients(Message.RecipientType.TO,parseAddress(to));
    if (subject != null)     msg.setSubject(subject);
  }
 catch (  MessagingException e) {
    LogLog.error("Could not activate SMTPAppender options.",e);
  }
}
