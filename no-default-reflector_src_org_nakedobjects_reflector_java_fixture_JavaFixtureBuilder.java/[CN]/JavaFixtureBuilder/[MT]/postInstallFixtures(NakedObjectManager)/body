{
  objectManager.startTransaction();
  try {
    for (int i=0; i < newInstances.size(); i++) {
      NakedObject object=(NakedObject)newInstances.elementAt(i);
      LOG.debug("Persisting " + object);
      boolean notPersistent=object.getOid() == null;
      if (notPersistent) {
        objectManager.makePersistent(object);
      }
    }
    objectManager.saveChanges();
    objectManager.endTransaction();
  }
 catch (  RuntimeException e) {
    LOG.error("Exception during fixture installation; aborting transaction",e);
    try {
      objectManager.abortTransaction();
    }
 catch (    Exception e2) {
      ExceptionHelper.log(ActionTransaction.class,"Failure during abort",e2);
    }
    throw e;
  }
  newInstances.removeAllElements();
}
