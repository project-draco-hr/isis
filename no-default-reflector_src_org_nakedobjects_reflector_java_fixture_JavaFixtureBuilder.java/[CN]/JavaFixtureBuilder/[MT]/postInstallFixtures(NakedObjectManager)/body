{
  objectManager.startTransaction();
  try {
    for (int i=0; i < newInstances.size(); i++) {
      NakedObject object=(NakedObject)newInstances.elementAt(i);
      LOG.debug("Persisting " + object);
      boolean notPersistent=object.getOid() == null;
      if (notPersistent) {
        objectManager.makePersistent(object);
      }
    }
    objectManager.saveChanges();
    objectManager.endTransaction();
  }
 catch (  RuntimeException e) {
    objectManager.abortTransaction();
    throw e;
  }
  newInstances.removeAllElements();
}
