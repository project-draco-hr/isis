{
  NakedObjectSpecification cls=object.getSpecification();
  ObjectData d=new ObjectData(object.getOid(),cls.getFullName());
  NakedObjectField[] fields=cls.getFields();
  for (int i=0; i < fields.length; i++) {
    NakedObjectField field=fields[i];
    if (!field.isDerived()) {
      if (field instanceof OneToManyAssociation) {
        InternalCollection coll=(InternalCollection)object.getField(field);
        d.addField(field.getName(),createData(coll));
      }
 else       if (field instanceof OneToOneAssociation) {
        NakedObject ref=object.getAssociation((OneToOneAssociation)field);
        Object refOid=ref == null ? null : new Data(ref.getOid(),ref.getSpecification().getFullName());
        d.addField(field.getName(),refOid);
      }
    }
  }
  return d;
}
