{
  Image iconImage;
  if (height == image.getHeight(null)) {
    return image;
  }
  iconImage=image.getScaledInstance(-1,height,java.awt.Image.SCALE_SMOOTH);
  if (iconImage != null) {
    mt.addImage(iconImage,0);
    try {
      mt.waitForAll();
    }
 catch (    final Exception e) {
      e.printStackTrace();
    }
    if (mt.isErrorAny()) {
      LOG.error("failed to create scaled image: " + iconImage + " "+ mt.getErrorsAny()[0]);
      mt.removeImage(iconImage);
      iconImage=null;
    }
 else {
      mt.removeImage(iconImage);
      if (LOG.isDebugEnabled()) {
        LOG.debug("image " + iconImage + " scaled to "+ height);
      }
    }
  }
  if (iconImage == null) {
    throw new RuntimeException("no icon image!");
  }
 else {
    if (iconImage.getWidth(null) == -1) {
      throw new RuntimeException("scaled image! " + iconImage.toString());
    }
  }
  return iconImage;
}
