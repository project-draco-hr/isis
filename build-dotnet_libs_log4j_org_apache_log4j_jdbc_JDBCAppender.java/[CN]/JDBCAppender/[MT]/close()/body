{
  flushBuffer();
  try {
    if (connection != null && !connection.isClosed())     connection.close();
  }
 catch (  SQLException e) {
    errorHandler.error("Error closing connection",e,ErrorCode.GENERIC_FAILURE);
  }
  this.closed=true;
}
