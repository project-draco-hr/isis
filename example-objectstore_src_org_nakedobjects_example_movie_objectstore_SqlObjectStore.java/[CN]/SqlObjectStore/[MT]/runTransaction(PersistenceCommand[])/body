{
  Connection connection=null;
  try {
    connection=DriverManager.getConnection("jdbc:mysql://localhost:3306/movies","rcm","rcm");
    connection.setAutoCommit(false);
    for (int i=0; i < commands.length; i++) {
      ((SqlCommand)commands[i]).execute(connection);
    }
    connection.commit();
  }
 catch (  SQLException e) {
    try {
      connection.rollback();
    }
 catch (    SQLException e1) {
      e1.printStackTrace();
    }
    throw new ObjectStoreException("Failed to run transaction",e);
  }
 finally {
    if (connection != null) {
      try {
        connection.close();
      }
 catch (      SQLException e) {
        throw new ObjectStoreException("Failed to close connection",e);
      }
    }
  }
}
