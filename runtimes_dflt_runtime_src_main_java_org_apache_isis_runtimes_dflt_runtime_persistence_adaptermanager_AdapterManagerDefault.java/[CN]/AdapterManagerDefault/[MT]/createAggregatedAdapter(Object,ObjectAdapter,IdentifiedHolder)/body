{
  Identifier identifier=identifiedHolder.getIdentifier();
  ensureMapsConsistent(ownerAdapter);
  Assert.assertNotNull(pojo);
  if (!(identifiedHolder instanceof OneToManyAssociation)) {
    throw new IsisException("only applicable to collections " + pojo + " in "+ identifiedHolder);
  }
  final Oid aggregatedOid=new AggregatedOid(ownerAdapter.getOid(),identifier.getMemberName());
  ObjectAdapter aggregatedAdapter=createOrRecreateAdapter(pojo,aggregatedOid);
  final TypeOfFacet facet=identifiedHolder.getFacet(TypeOfFacet.class);
  aggregatedAdapter.setElementSpecificationProvider(ElementSpecificationProviderFromTypeOfFacet.createFrom(facet));
  aggregatedAdapter.setOptimisticLock(ownerAdapter.getVersion());
  return aggregatedAdapter;
}
