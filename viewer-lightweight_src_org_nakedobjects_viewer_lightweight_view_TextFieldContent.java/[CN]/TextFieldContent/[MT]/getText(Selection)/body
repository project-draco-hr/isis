{
  CursorPosition from=selection.from();
  CursorPosition to=selection.to();
  if (from.getLine() == to.getLine()) {
    BlockReference block=getBlockFor(from.getLine());
    return block.block.getText().substring(from.getCharacter(),to.getCharacter());
  }
 else {
    throw new NotImplementedException();
  }
}
