{
  if (debugMode == DebugMode.ON) {
    return true;
  }
 else   if (session != null && debugMode == DebugMode.SYSADMIN_ONLY && session.getRoles().contains("sysadmin")) {
    return true;
  }
 else   if (session != null && debugMode == DebugMode.NAMED && (debugUsers.contains(session.getUserName()) || session.getRoles().contains("sysadmin"))) {
    return true;
  }
  return false;
}
