{
  return new IsisSystemWithFixtures.ListenerAdapter(){
    @Override public void postSetupSystem(    boolean firstTime) throws Exception {
      Connection connection=getConnection();
      try {
        final Statement statement=connection.createStatement();
        for (        String table : tables) {
          statement.executeUpdate("DELETE FROM " + table);
        }
      }
 catch (      Exception ex) {
        connection.rollback();
        throw ex;
      }
 finally {
        connection.commit();
      }
    }
    private Connection getConnection(){
      final DataNucleusObjectStore objectStore=(DataNucleusObjectStore)IsisContext.getPersistenceSession().getObjectStore();
      return objectStore.getJavaSqlConnection();
    }
  }
;
}
