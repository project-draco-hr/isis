{
  LOG.info("starting archiving");
  final LogRange logFileRange=Util.logFileRange();
  if (logFileRange.noLogFile()) {
    System.err.println("No recovery files found");
    System.exit(0);
  }
  long lastId=logFileRange.getLast();
  LOG.info("last log file is " + Util.logFile(lastId).getName());
  long endId=lastId - 1;
  int size=list.size();
  if (size > 0) {
    endId=Long.valueOf((String)list.get(0));
  }
  if (endId >= lastId) {
    System.err.println("File ID invalid: they must be less that " + lastId);
    System.exit(0);
  }
  long startId=logFileRange.getFirst();
  for (long id=startId; id <= endId; id++) {
    File file=Util.logFile(id);
    LOG.info("moving " + file.getName());
    File destination=Util.archiveLogFile(id);
    file.renameTo(destination);
  }
  LOG.info("archive complete");
}
