{
  Parameter[] parameters=storedProcedure.getParameters();
  StringBuffer sql=new StringBuffer("{call ");
  sql.append(storedProcedure.getName());
  sql.append(" (");
  for (int i=0, no=parameters.length; i < no; i++) {
    sql.append(i == 0 ? "?" : ",?");
  }
  sql.append(")}");
  LOG.debug("SQL: " + sql);
  CallableStatement statement;
  try {
    statement=connection.prepareCall(sql.toString());
    for (int i=0; i < parameters.length; i++) {
      LOG.debug("  setup param " + i + " "+ parameters[i]);
      parameters[i].setupParameter(i + 1,parameters[i].getName(),storedProcedure);
    }
    LOG.debug("   execute ");
    statement.execute();
    for (int i=0; i < parameters.length; i++) {
      parameters[i].retrieve(i + 1,parameters[i].getName(),storedProcedure);
      LOG.debug("  retrieve param " + i + " "+ parameters[i]);
    }
  }
 catch (  SQLException e) {
    throw new NakedObjectRuntimeException(e);
  }
}
