{
  if (!isMap()) {
    throw new IllegalStateException("does not represent map");
  }
  if (value == null) {
    return;
  }
  Path path=Path.parse(key);
  ObjectNode node=JsonNodeUtils.walkNodeUpTo(nodeAsMap(),path.getHead());
  if (node.has(path.getTail())) {
    throw new IllegalStateException("already has key " + key);
  }
  node.put(path.getTail(),value.asJsonNode());
}
