{
  final AuthenticationRequestPassword passwordRequest=(AuthenticationRequestPassword)request;
  final String username=passwordRequest.getName();
  if (Strings.isNullOrEmpty(username)) {
    return false;
  }
  final String password=passwordRequest.getPassword();
  Assert.assertNotNull(password);
  BufferedReader reader=null;
  try {
    InputStream readStream=resourceStreamSource.readResource(FileAuthenticationConstants.PASSWORDS_FILE);
    if (readStream == null) {
      throw new IsisException("Failed to open password file: " + FileAuthenticationConstants.PASSWORDS_FILE + " from "+ resourceStreamSource.getName());
    }
    reader=new BufferedReader(new InputStreamReader(readStream));
    String line;
    while ((line=reader.readLine()) != null) {
      if (commentedOutOrEmpty(line)) {
        continue;
      }
      if (line.indexOf(':') == -1) {
        throw new IsisException("Invalid entry in password file - no colon (:) found on line: " + line);
      }
      final String name=line.substring(0,line.indexOf(':'));
      if (!name.equals(username)) {
        continue;
      }
      return isPasswordValidForUser(request,password,line);
    }
    return false;
  }
 catch (  final IOException e) {
    throw new IsisException("Failed to read password file: " + FileAuthenticationConstants.PASSWORDS_FILE + " from "+ resourceStreamSource.getName());
  }
 finally {
    IoUtils.closeSafely(reader);
  }
}
