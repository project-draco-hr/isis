{
  Assert.assertNotNull("Class to instantiate must be specified",className);
  try {
    final Class<?> loadedClass=loadClass(className);
    if (requiredType != null && !requiredType.isAssignableFrom(loadedClass)) {
      throw new InstanceCreationClassException("Class '" + className + "' is not of type '"+ requiredType+ "'");
    }
    return CastUtils.cast(loadedClass);
  }
 catch (  final NoClassDefFoundError e) {
    throw new InstanceCreationClassException("Default type '" + className + "' found, but is missing a dependent class: "+ e.getMessage(),e);
  }
}
