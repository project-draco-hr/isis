{
  String fileName=file.trim();
  if (fileName.startsWith(GENERIC)) {
    Object result=context.getVariable(RequestContext.RESULT);
    ObjectAdapter mappedObject=MethodsUtils.findObject(context,(String)result);
    if (mappedObject == null) {
      throw new ScimpiException("No object mapping for " + result);
    }
    if (fileName.equals(GENERIC + "." + EXTENSION)) {
      Facet facet=mappedObject.getSpecification().getFacet(CollectionFacet.class);
      if (facet != null) {
        ObjectSpecification specification=mappedObject.getSpecification();
        TypeOfFacet facet2=specification.getFacet(TypeOfFacet.class);
        file=findFileForSpecification(context,facet2.valueSpec(),"collection",EXTENSION);
      }
 else {
        ObjectAdapter mappedObject2=mappedObject;
        if (mappedObject2.isTransient()) {
          file=findFileForSpecification(context,mappedObject.getSpecification(),"edit",EXTENSION);
        }
 else {
          file=findFileForSpecification(context,mappedObject.getSpecification(),"object",EXTENSION);
        }
      }
    }
 else     if (fileName.equals(GENERIC + EDIT + "."+ EXTENSION)) {
      file=findFileForSpecification(context,mappedObject.getSpecification(),"edit",EXTENSION);
    }
 else     if (fileName.equals(GENERIC + ACTION + "."+ EXTENSION)) {
      String method=context.getParameter("method");
      file=findFileForSpecification(context,mappedObject.getSpecification(),method,"action",EXTENSION);
    }
  }
  return file;
}
