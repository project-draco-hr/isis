{
  putIfNotPresent(props,PropertyNames.PROPERTY_OBJECT_PROVIDER_CLASS_NAME,"org.apache.isis.objectstore.jdo.datanucleus.JDOStateManagerForIsis");
  putIfNotPresent(props,"javax.jdo.PersistenceManagerFactoryClass","org.datanucleus.api.jdo.JDOPersistenceManagerFactory");
  putIfNotPresent(props,PropertyNames.PROPERTY_SCHEMA_AUTOCREATE_SCHEMA,"true");
  putIfNotPresent(props,PropertyNames.PROPERTY_SCHEMA_VALIDATE_ALL,"true");
  putIfNotPresent(props,PropertyNames.PROPERTY_CACHE_L2_TYPE,"none");
  putIfNotPresent(props,PropertyNames.PROPERTY_PERSISTENCE_UNIT_LOAD_CLASSES,"true");
  String connectionFactoryName=props.get(PropertyNames.PROPERTY_CONNECTION_FACTORY_NAME);
  if (connectionFactoryName != null) {
    String connectionFactory2Name=props.get(PropertyNames.PROPERTY_CONNECTION_FACTORY2_NAME);
    String transactionType=props.get("javax.jdo.option.TransactionType");
    if (transactionType == null) {
      LOG.info("found non-JTA JNDI datasource (" + connectionFactoryName + ")");
      if (connectionFactory2Name != null) {
        LOG.warn("found non-JTA JNDI datasource (" + connectionFactoryName + "); second '-nontx' JNDI datasource configured but will not be used ("+ connectionFactory2Name+ ")");
      }
    }
 else     LOG.info("found JTA JNDI datasource (" + connectionFactoryName + ")");
    if (connectionFactory2Name == null) {
      LOG.error("found JTA JNDI datasource (" + connectionFactoryName + ") but second '-nontx' JNDI datasource *not* found");
    }
 else {
      LOG.info("... and second '-nontx' JNDI datasource found; " + connectionFactory2Name);
    }
    return;
  }
 else {
    LOG.info("did *not* find JNDI datasource; will use JDBC");
    putIfNotPresent(props,"javax.jdo.option.ConnectionDriverName","org.hsqldb.jdbcDriver");
    putIfNotPresent(props,"javax.jdo.option.ConnectionURL","jdbc:hsqldb:mem:test");
    putIfNotPresent(props,"javax.jdo.option.ConnectionUserName","sa");
    putIfNotPresent(props,"javax.jdo.option.ConnectionPassword","");
  }
}
