{
  Element parentChoiceOrSequenceElement=xsMeta.choiceOrSequenceFor(xsMeta.complexTypeFor(parentXsElement));
  if (parentChoiceOrSequenceElement == null) {
    throw new IllegalArgumentException("Unable to locate complexType/sequence or complexType/choice under supplied parent XSD element");
  }
  NamedNodeMap childXsElementAttributeMap=childXsElement.getAttributes();
  Attr childXsElementAttr=(Attr)childXsElementAttributeMap.getNamedItem("name");
  String localName=childXsElementAttr.getValue();
  NodeList existingElements=parentChoiceOrSequenceElement.getElementsByTagNameNS("*",childXsElement.getLocalName());
  for (int i=0; i < existingElements.getLength(); i++) {
    Element xsElement=(Element)existingElements.item(i);
    NamedNodeMap xsElementAttributeMap=xsElement.getAttributes();
    Attr attr=(Attr)xsElementAttributeMap.getNamedItem("name");
    if (attr != null && attr.getValue().equals(localName)) {
      return xsElement;
    }
  }
  parentChoiceOrSequenceElement.appendChild(childXsElement);
  return childXsElement;
}
