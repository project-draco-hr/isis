{
  LogManager.getLoggerRepository().setThreshold(Level.ERROR);
  objectManager=createObjectManager();
  try {
    NakedObjectContext con=new NakedObjectContext(objectManager);
    explorationSetUp=new ExplorationSetUp(con);
    setUpFixture();
    setUpFixtures();
    if (testObjectFactory == null) {
      testObjectFactory=new HtmlTestObjectFactory();
    }
    documentor=testObjectFactory.getDocumentor(getName().substring(4));
    explorationSetUp.installFixtures();
    String[] cls=explorationSetUp.getClasses();
    for (int i=0; i < cls.length; i++) {
      NakedObjectSpecification nc=NakedObjectSpecification.getNakedClass(cls[i]);
      NakedClass spec=new NakedClass(cls[i]);
      spec.setContext(con);
      spec.setNakedClass(nc);
      TestClass view=testObjectFactory.createTestClass(context,spec);
      classes.put(nc.getFullName().toLowerCase(),view);
    }
  }
 catch (  Exception e) {
    e.printStackTrace();
    objectManager.shutdown();
    throw e;
  }
}
