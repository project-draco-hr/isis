{
  final int posFirstColon=line.indexOf(':');
  final int posPasswordStart=posFirstColon + 1;
  final int posSecondColonIfAny=line.indexOf(':',posPasswordStart);
  final int posPasswordEnd=posSecondColonIfAny == -1 ? line.length() : posSecondColonIfAny;
  final String parsedPassword=line.substring(posPasswordStart,posPasswordEnd);
  if (parsedPassword.equals(password)) {
    if (posSecondColonIfAny != -1) {
      setRoles(request,line.substring(posSecondColonIfAny + 1));
    }
    return true;
  }
 else {
    return false;
  }
}
