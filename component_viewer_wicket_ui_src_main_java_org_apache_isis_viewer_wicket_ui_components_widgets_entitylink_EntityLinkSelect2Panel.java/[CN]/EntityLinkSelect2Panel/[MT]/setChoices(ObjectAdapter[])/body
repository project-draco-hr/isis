{
  final ChoiceProvider<ObjectAdapterMemento> provider;
  if (getScalarModel().hasChoices()) {
    final List<ObjectAdapterMemento> choiceMementos=getChoiceMementos(argsIfAvailable);
    provider=new ObjectAdapterMementoProviderAbstract(){
      private static final long serialVersionUID=1L;
      @Override protected List<ObjectAdapterMemento> obtainMementos(      String unused){
        return choiceMementos;
      }
    }
;
    final ObjectAdapterMemento curr=select2Field.getModelObject();
    select2Field.setProvider(provider);
    getScalarModel().clearPending();
    if (curr == null || !curr.containedIn(choiceMementos)) {
      final ObjectAdapterMemento newAdapterMemento=!choiceMementos.isEmpty() ? choiceMementos.get(0) : null;
      select2Field.getModel().setObject(newAdapterMemento);
      getModel().setObject(newAdapterMemento != null ? newAdapterMemento.getObjectAdapter(ConcurrencyChecking.NO_CHECK) : null);
    }
  }
 else   if (hasParamOrPropertyAutoComplete()) {
    provider=providerForParamOrPropertyAutoComplete();
    select2Field.setProvider(provider);
    getScalarModel().setPending(null);
  }
 else {
    provider=providerForObjectAutoComplete();
    select2Field.setProvider(provider);
    getScalarModel().setPending(null);
  }
}
