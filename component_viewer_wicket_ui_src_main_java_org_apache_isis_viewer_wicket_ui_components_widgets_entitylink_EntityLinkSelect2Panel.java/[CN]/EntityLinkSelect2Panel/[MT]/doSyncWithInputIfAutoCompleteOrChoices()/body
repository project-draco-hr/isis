{
  if (!isEditableWithEitherAutoCompleteOrChoices()) {
    permanentlyHide(ID_AUTO_COMPLETE);
    return;
  }
  final IModel<ObjectAdapterMemento> model=ScalarModelWithPending.Util.createModel(getScalarModel().asScalarModelWithPending());
  if (select2Field == null) {
    select2Field=Select2ChoiceUtil.newSelect2Choice(ID_AUTO_COMPLETE,model,getScalarModel());
    setProviderAndCurrAndPending(select2Field,getScalarModel().getActionArgsHint());
    if (!getScalarModel().hasChoices()) {
      final Settings settings=select2Field.getSettings();
      ScalarModel scalarModel=getScalarModel();
      final int minLength=scalarModel.getAutoCompleteMinLength();
      settings.setMinimumInputLength(minLength);
      settings.setPlaceholder(scalarModel.getName());
    }
    addOrReplace(select2Field);
  }
 else {
    select2Field.clearInput();
  }
  permanentlyHide(ID_ENTITY_ICON_AND_TITLE);
}
