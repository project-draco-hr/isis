{
  Oid oid=collection.getOid();
  String type=collection.getSpecification().getFullName();
  Enumeration e=collection.elements();
  ObjectData[] elements=new ObjectData[collection.size()];
  int i=0;
  while (e.hasMoreElements()) {
    NakedObject element=(NakedObject)e.nextElement();
    elements[i++]=createObjectData(element,recursePersistentObjects,depth);
  }
  boolean hasAllElements=collection.getResolveState() == ResolveState.TRANSIENT || collection.getResolveState() == ResolveState.RESOLVED;
  return createCollectionData(oid,type,elements,hasAllElements,collection.getVersion());
}
