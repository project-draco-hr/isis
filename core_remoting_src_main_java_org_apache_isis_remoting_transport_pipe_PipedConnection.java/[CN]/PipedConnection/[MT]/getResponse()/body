{
  while (response == null && exception == null) {
    try {
      wait();
    }
 catch (    final InterruptedException e) {
      LOG.error("wait (getResponse) interrupted",e);
    }
  }
  if (exception != null) {
    final RuntimeException toThrow=exception;
    exception=null;
    throw toThrow;
  }
  final ResponseEnvelope r=response;
  response=null;
  notify();
  return r;
}
