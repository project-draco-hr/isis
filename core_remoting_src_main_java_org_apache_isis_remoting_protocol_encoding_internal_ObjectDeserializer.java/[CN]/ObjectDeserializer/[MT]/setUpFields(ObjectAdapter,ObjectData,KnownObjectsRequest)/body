{
  final Data[] fieldContent=adapterData.getFieldContent();
  if (fieldContent != null && fieldContent.length > 0) {
    final ObjectAssociation[] fields=fieldOrderCache.getFields(adapter.getSpecification());
    if (fields.length != fieldContent.length) {
      throw new IsisRemoteException("Data received for different number of fields; expected " + fields.length + ", but was "+ fieldContent.length);
    }
    for (int i=0; i < fields.length; i++) {
      final ObjectAssociation field=fields[i];
      final Data fieldData=fieldContent[i];
      if (fieldData == null || field.isNotPersisted()) {
        LOG.debug("no data for field " + field.getId());
        continue;
      }
      if (field.isOneToManyAssociation()) {
        setUpCollectionField(adapter,adapterData,field,(CollectionData)fieldData,knownObjects);
      }
 else       if (field.getSpecification().isEncodeable()) {
        setUpEncodedField(adapter,(OneToOneAssociation)field,fieldData);
      }
 else {
        setUpReferenceField(adapter,(OneToOneAssociation)field,fieldData,knownObjects);
      }
    }
  }
}
