{
  try {
    HibernateUtil.startTransaction();
    final SQLQuery sq=HibernateUtil.getCurrentSession().createSQLQuery(flag == null ? NO_FLAG_MATCH : FLAG_MATCH);
    sq.setString(0,role);
    sq.setString(1,key);
    if (flag != null) {
      sq.setInteger(2,flag.intValue());
    }
    final Number count=(Number)sq.uniqueResult();
    HibernateUtil.commitTransaction();
    return count != null && count.intValue() > 0;
  }
 catch (  final Exception e) {
    HibernateUtil.rollbackTransaction();
    throw new IsisException(e);
  }
}
