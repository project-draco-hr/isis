{
  Assert.assertNotNull(type);
  final String typeName=type.getName();
  final SpecificationCache specificationCache=getCache();
synchronized (specificationCache) {
    final ObjectSpecification spec=specificationCache.get(typeName);
    if (spec != null) {
      return spec;
    }
    final ObjectSpecification specification=createSpecification(type);
    if (specification == null) {
      throw new IsisException("Failed to create specification for class " + typeName);
    }
    specificationCache.cache(typeName,specification);
    introspectSpecificationIfRequired(specification);
    return specification;
  }
}
