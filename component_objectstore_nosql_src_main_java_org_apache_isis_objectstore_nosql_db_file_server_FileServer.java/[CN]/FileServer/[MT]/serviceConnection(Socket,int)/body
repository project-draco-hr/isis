{
  try {
    final InputStream input=connection.getInputStream();
    final OutputStream output=connection.getOutputStream();
    final ServerConnection pipe=new ServerConnection(input,output);
    requests++;
    server.process(pipe);
    pipe.logComplete();
  }
 catch (  final NoSqlStoreException e) {
    if (e.getCause() instanceof SocketTimeoutException) {
      LOG.error("read timed out after " + (readTimeout / 1000.0) + " seconds",e);
    }
 else {
      LOG.error("file server failure",e);
    }
  }
catch (  final IOException e) {
    LOG.error("networking failure",e);
  }
catch (  final RuntimeException e) {
    LOG.error("request failure",e);
  }
 finally {
    try {
      connection.close();
    }
 catch (    final IOException e) {
      LOG.warn("failure to close connection",e);
    }
  }
}
