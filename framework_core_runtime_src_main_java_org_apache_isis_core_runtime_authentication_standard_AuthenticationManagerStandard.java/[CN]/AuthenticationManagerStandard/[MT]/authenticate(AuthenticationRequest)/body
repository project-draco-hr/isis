{
  if (request == null) {
    return null;
  }
  for (  Authenticator authenticator : authenticators) {
    if (authenticator.canAuthenticate(request.getClass())) {
      AuthenticationSession authSession=null;
      authSession=authenticator.authenticate(request,getUnusedRandomCode());
      if (authSession != null) {
        userByValidationCode.put(authSession.getValidationCode(),authSession.getUserName());
        return authSession;
      }
    }
  }
  throw new NoAuthenticatorException("No authenticator available for processing " + request.getClass().getName());
}
