{
  if (!IsisContext.inSession()) {
    chain.doFilter(request,response);
    return;
  }
  getTransactionManager().startTransaction();
  try {
    chain.doFilter(request,response);
  }
  finally {
    final boolean inTransaction=inTransaction();
    if (inTransaction) {
      getTransactionManager().endTransaction();
    }
  }
}
