{
  final IsisConfiguration config=HibernateUtil.getNofConfiguration();
  if (config.hasProperty(HibernateConstants.HIB_INITIALIZED_KEY)) {
    return config.getBoolean(HibernateConstants.HIB_INITIALIZED_KEY);
  }
  final Session session=getSessionFactory().openSession();
  Transaction tx=null;
  boolean isInitialized=false;
  try {
    tx=session.beginTransaction();
    final DatabaseMetaData metaData=session.connection().getMetaData();
    final String tableName=config.getString(HibernateConstants.PROPERTY_PREFIX + "initialized.table");
    if (tableName != null) {
      isInitialized=!tableExists(metaData,config.getString(HibernateConstants.PROPERTY_PREFIX + "initialized.catalog"),config.getString(HibernateConstants.PROPERTY_PREFIX + "initialized.schema"),config.getString(HibernateConstants.PROPERTY_PREFIX + "initialized.table"));
    }
 else {
      for (final Iterator<?> iter=HibernateUtil.configuration.getTableMappings(); iter.hasNext(); ) {
        final Table t=(Table)iter.next();
        if (t.isPhysicalTable()) {
          isInitialized=tableExists(metaData,t.getCatalog(),t.getSchema(),t.getName());
          break;
        }
      }
    }
    tx.commit();
  }
 catch (  final SQLException e) {
    tx.rollback();
    throw new IsisException(e);
  }
 finally {
    session.close();
  }
  return isInitialized;
}
