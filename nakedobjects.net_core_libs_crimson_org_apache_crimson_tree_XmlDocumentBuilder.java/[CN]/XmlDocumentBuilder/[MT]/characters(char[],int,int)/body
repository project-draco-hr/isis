{
  ParentNode top=elementStack[topOfStack];
  if (inCDataSection) {
    String temp=new String(buf,offset,len);
    CDATASection section;
    section=(CDATASection)top.getLastChild();
    section.appendData(temp);
    return;
  }
  try {
    NodeBase lastChild=(NodeBase)top.getLastChild();
    if (lastChild != null && lastChild.getClass() == TextNode.class) {
      String tmp=new String(buf,offset,len);
      ((TextNode)lastChild).appendData(tmp);
    }
 else {
      TextNode text=document.newText(buf,offset,len);
      top.appendChild(text);
    }
  }
 catch (  DOMException ex) {
    throw new SAXParseException(getMessage("XDB-004",new Object[]{ex.getMessage()}),locator,ex);
  }
}
