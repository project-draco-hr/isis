{
  final HttpServletRequest httpServletRequest=(HttpServletRequest)servletRequest;
  final String authStr=httpServletRequest.getHeader("Authorization");
  if (authStr == null || !authStr.startsWith("Basic ")) {
    return null;
  }
  final String digest=authStr.substring(6);
  final String userAndPassword=new String(new Base64().decode(digest.getBytes()));
  final Matcher matcher=USER_AND_PASSWORD_REGEX.matcher(userAndPassword);
  if (!matcher.matches()) {
    return null;
  }
  final String user=matcher.group(1);
  final String password=matcher.group(2);
  final AuthenticationSession authSession=getAuthenticationManager().authenticate(new AuthenticationRequestPassword(user,password));
  return authSession;
}
