{
  if (alreadyPersistedOrNotPersistable(collection)) {
    return;
  }
  LOG.info("persist " + collection);
  if (collection.getResolveState() == ResolveState.TRANSIENT) {
    collection.changeState(ResolveState.RESOLVED);
  }
  toPersistObjectSet.remapAsPersistent(collection);
  final CollectionFacet facet=CollectionFacetUtils.getCollectionFacetFromSpec(collection);
  for (  ObjectAdapter adapter : facet.iterable(collection)) {
    makePersistent(adapter,toPersistObjectSet);
  }
}
