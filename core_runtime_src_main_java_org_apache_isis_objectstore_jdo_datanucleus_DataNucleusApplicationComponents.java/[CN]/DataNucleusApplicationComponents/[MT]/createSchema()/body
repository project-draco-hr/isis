{
  final JDOPersistenceManagerFactory jdopmf=(JDOPersistenceManagerFactory)persistenceManagerFactory;
  final NucleusContext nucleusContext=jdopmf.getNucleusContext();
  if (nucleusContext instanceof StoreNucleusContext) {
    final StoreManager storeManager=((StoreNucleusContext)nucleusContext).getStoreManager();
    final MetaDataManager metaDataManager=nucleusContext.getMetaDataManager();
    registerMetadataListener(metaDataManager);
    if (storeManager instanceof SchemaAwareStoreManager) {
      ((SchemaAwareStoreManager)storeManager).createSchemaForClasses(persistableClassNameSet,asProperties(datanucleusProps));
    }
  }
}
