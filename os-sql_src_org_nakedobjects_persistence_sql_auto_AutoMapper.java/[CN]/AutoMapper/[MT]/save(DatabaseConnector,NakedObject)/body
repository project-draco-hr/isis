{
  NakedObjectSpecification cls=object.getSpecification();
  String updateWhereClause=updateWhereClause(object,true);
  ((AbstractNakedObject)object).getLastActivity().reset();
  StringBuffer assignments=new StringBuffer();
  int fld=0;
  for (int i=0; i < fields.length; i++) {
    Naked fieldValue=fields[i].get(object);
    if (i > 0) {
      assignments.append(", ");
    }
    assignments.append(columnNames[fld++]);
    assignments.append('=');
    if (fieldValue instanceof NakedObject) {
      if (fieldValue == null) {
        assignments.append("NULL");
      }
 else {
        Object oid=((NakedObject)fieldValue).getOid();
        assignments.append(primaryKey(oid));
      }
    }
 else     if (fieldValue instanceof NakedValue) {
      ValueMapper mapper=typeMapper.mapperFor(fields[i].getType());
      assignments.append(mapper.valueAsDBString((NakedValue)fieldValue));
    }
 else {
      assignments.append("NULL");
    }
  }
  String id=primaryKey(object.getOid());
  String statement="update " + table + " set "+ assignments+ " where "+ idColumn+ "="+ id+ updateWhereClause;
  int updateCount=connector.update(statement);
  if (updateCount == 0) {
    throw new NakedObjectRuntimeException(new NakedObjectRuntimeException("No update: " + statement));
  }
  for (int i=0; i < collectionMappers.length; i++) {
    collectionMappers[i].saveInternalCollection(connector,object);
  }
}
