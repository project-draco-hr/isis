{
  for (int i=0; i < fields.length; i++) {
    if (fields[i] instanceof Value) {
      ValueMapper mapper=ValueMapperLookup.getInstance().mapperFor(fields[i].getType());
      mapper.setFromDBColumn(columnNames[i],fields[i],object,rs);
    }
 else     if (fields[i] instanceof OneToOneAssociation) {
      NakedClass associatedCls=NakedClassManager.getInstance().getNakedClass(fields[i].getType().getName());
      Object oid=recreateOid(rs,associatedCls,columnNames[i]);
      if (oid != null) {
        if (associatedCls.isAbstract()) {
          LOG.warn("NOT DEALING WITH POLYMORPHIC ASSOCIATIONS");
        }
 else {
          NakedObject reference=loadObject(associatedCls,oid);
          ((OneToOneAssociation)fields[i]).initData(object,reference);
        }
      }
    }
 else {
      throw new NakedObjectRuntimeException();
    }
  }
}
