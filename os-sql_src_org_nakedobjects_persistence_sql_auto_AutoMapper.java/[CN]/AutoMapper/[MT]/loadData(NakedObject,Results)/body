{
  for (int i=0; i < fields.length; i++) {
    if (fields[i].isValue()) {
      ValueMapper mapper=ValueMapperLookup.getInstance().mapperFor(fields[i].getSpecification());
      mapper.setFromDBColumn(columnNames[i],fields[i],object,rs);
    }
 else     if (fields[i].isObject()) {
      NakedObjectSpecification associatedCls=fields[i].getSpecification();
      Oid oid=recreateOid(rs,associatedCls,columnNames[i]);
      if (oid != null) {
        if (associatedCls.isAbstract()) {
          LOG.warn("NOT DEALING WITH POLYMORPHIC ASSOCIATIONS");
        }
 else {
          NakedObject reference=loadObject(associatedCls,oid);
          object.setValue((OneToOneAssociation)fields[i],reference);
        }
      }
    }
 else {
      throw new NakedObjectRuntimeException();
    }
  }
}
