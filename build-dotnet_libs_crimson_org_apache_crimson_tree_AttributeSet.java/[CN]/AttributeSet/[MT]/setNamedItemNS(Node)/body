{
  if (readonly) {
    throw new DomEx(DomEx.NO_MODIFICATION_ALLOWED_ERR);
  }
  if (!(arg instanceof AttributeNode) || arg.getOwnerDocument() != ownerElement.getOwnerDocument()) {
    throw new DomEx(DomEx.WRONG_DOCUMENT_ERR);
  }
  AttributeNode attr=(AttributeNode)arg;
  if (attr.getOwnerElement() != null) {
    throw new DomEx(DomEx.INUSE_ATTRIBUTE_ERR);
  }
  String localName=attr.getLocalName();
  String namespaceURI=attr.getNamespaceURI();
  int length=list.size();
  for (int i=0; i < length; i++) {
    AttributeNode oldNode=(AttributeNode)item(i);
    String iLocalName=oldNode.getLocalName();
    String iNamespaceURI=oldNode.getNamespaceURI();
    if ((localName == iLocalName || (localName != null && localName.equals(iLocalName))) && (namespaceURI == iNamespaceURI || (namespaceURI != null && namespaceURI.equals(iNamespaceURI)))) {
      if (oldNode.isReadonly()) {
        throw new DomEx(DomEx.NO_MODIFICATION_ALLOWED_ERR);
      }
      attr.setOwnerElement(ownerElement);
      list.setElementAt(attr,i);
      oldNode.setOwnerElement(null);
      return oldNode;
    }
  }
  attr.setOwnerElement(ownerElement);
  list.addElement(attr);
  return null;
}
