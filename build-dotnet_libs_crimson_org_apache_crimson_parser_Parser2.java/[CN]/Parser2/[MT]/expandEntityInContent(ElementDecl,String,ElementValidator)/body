{
  Object entity=entities.get(name);
  InputEntity last=in;
  if (entity == null) {
    fatal("P-014",new Object[]{name});
  }
  if (entity instanceof InternalEntity) {
    InternalEntity e=(InternalEntity)entity;
    if (supportValidation && isValidating && isStandalone&& !e.isFromInternalSubset)     error("V-002",new Object[]{name});
    pushReader(e.buf,name,true);
    content(element,true,validator);
    if (in != last && !in.isEOF()) {
      while (in.isInternal())       in=in.pop();
      fatal("P-052",new Object[]{name});
    }
    lexicalHandler.endEntity(name);
    in=in.pop();
  }
 else   if (entity instanceof ExternalEntity) {
    ExternalEntity e=(ExternalEntity)entity;
    if (e.notation != null)     fatal("P-053",new Object[]{name});
    if (supportValidation && isValidating && isStandalone&& !e.isFromInternalSubset)     error("V-002",new Object[]{name});
    externalParsedEntity(element,e,validator);
  }
 else   throw new InternalError(name);
}
