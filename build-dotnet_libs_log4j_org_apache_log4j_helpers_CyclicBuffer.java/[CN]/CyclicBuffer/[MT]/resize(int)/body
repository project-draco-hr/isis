{
  if (newSize < 0) {
    throw new IllegalArgumentException("Negative array size [" + newSize + "] not allowed.");
  }
  if (newSize == numElems)   return;
  LoggingEvent[] temp=new LoggingEvent[newSize];
  int loopLen=newSize < numElems ? newSize : numElems;
  for (int i=0; i < loopLen; i++) {
    temp[i]=ea[first];
    ea[first]=null;
    if (++first == numElems)     first=0;
  }
  ea=temp;
  first=0;
  numElems=loopLen;
  maxSize=newSize;
  if (loopLen == newSize) {
    last=0;
  }
 else {
    last=loopLen;
  }
}
