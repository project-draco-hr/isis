{
  final Iterator<StateReader> instanceData=database.instancesOf(specification.getSpecId());
  while (instanceData.hasNext()) {
    final StateReader reader=instanceData.next();
    final ObjectAdapter instance=objectReader.load(reader,versionCreator,availableDataEncrypters);
    if (persistenceQuery instanceof PersistenceQueryBuiltIn) {
      if (!((PersistenceQueryBuiltIn)persistenceQuery).matches(instance)) {
        continue;
      }
    }
    instances.add(instance);
  }
  for (  final ObjectSpecification spec : specification.subclasses()) {
    appendInstances(persistenceQuery,spec,instances);
  }
}
