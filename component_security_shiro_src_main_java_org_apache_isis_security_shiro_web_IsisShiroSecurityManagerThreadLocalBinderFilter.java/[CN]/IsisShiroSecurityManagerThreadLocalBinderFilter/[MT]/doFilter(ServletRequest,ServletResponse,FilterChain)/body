{
  ServletContext servletContext=filterConfig.getServletContext();
  WebEnvironment webEnvironment=WebUtils.getWebEnvironment(servletContext);
  SecurityManager securityManager=webEnvironment.getSecurityManager();
  ThreadContext.bind(securityManager);
  try {
    chain.doFilter(request,response);
  }
  finally {
    ThreadContext.unbindSecurityManager();
  }
}
