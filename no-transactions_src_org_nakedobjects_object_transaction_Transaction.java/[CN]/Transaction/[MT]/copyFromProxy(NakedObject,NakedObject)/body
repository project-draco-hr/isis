{
  NakedObjectSpecification cls=proxy.getSpecification();
  FieldSpecification[] fields=cls.getFields();
  log("copy " + proxy + " -> "+ original);
  for (int i=0; i < fields.length; i++) {
    FieldSpecification field=fields[i];
    if (field instanceof ValueFieldSpecification) {
      copyToField((ValueFieldSpecification)field,proxy,original);
    }
 else     if (field instanceof OneToOneAssociationSpecification) {
      copyToField((OneToOneAssociationSpecification)field,proxy,original);
    }
 else     if (field instanceof OneToManyAssociationSpecification) {
      OneToManyAssociationSpecification association=(OneToManyAssociationSpecification)field;
      InternalCollection proxyCollection=(InternalCollection)proxy.getField(association);
      InternalCollection publicCollection=(InternalCollection)original.getField(association);
      publicCollection.removeAll();
      int size=proxyCollection.size();
      for (int j=0; j < size; j++) {
        NakedObject originalElement=(NakedObject)proxyCollection.elementAt(j);
        Object originalElementOid=originalElement.getOid();
        NakedObject elementCopy=getObject(originalElementOid,originalElement);
        if (elementCopy.isResolved()) {
          publicCollection.added(elementCopy);
          log("  copy: " + elementCopy + " -> "+ association.getName());
        }
      }
    }
  }
}
