{
  if (path == null) {
    throw new NullPointerException();
  }
  int pos=path.lastIndexOf('.');
  String root=pos == -1 ? path : path.substring(0,pos);
  if (images.contains(root)) {
    return (ImageTemplate)images.get(root);
  }
 else {
    Image image=null;
    if (pos >= 0) {
      image=load(path);
    }
 else {
      for (int i=0; i < EXTENSIONS.length; i++) {
        image=load(root + "." + EXTENSIONS[i]);
        if (image != null) {
          break;
        }
      }
    }
    if (image == null) {
      LOG.info("using fallback image for " + path);
      image=unknownImage;
    }
    ImageTemplate template=new ImageTemplate(image);
    images.put(root,template);
    return template;
  }
}
