{
  LOG.debug("collating changes");
  if (checkObjectsForDirtyFlag) {
    collateChanges();
  }
  Enumeration e=objectsToBeSaved.dirtyObjects();
  while (e.hasMoreElements()) {
    NakedObject object=(NakedObject)e.nextElement();
    LOG.debug("  changed " + object);
    if (isPersistent(object)) {
      getTransaction().addCommand(objectStore.createSaveObjectCommand(object));
    }
  }
}
