{
  NakedObject object;
  NakedObjectManager objectManager=NakedObjects.getObjectManager();
  try {
    object=objectManager.createTransientInstance(cls.forObjectType());
    objectManager.startTransaction();
    objectManager.makePersistent(object);
    objectManager.saveChanges();
    objectManager.endTransaction();
  }
 catch (  NotPersistableException e) {
    NakedError error=new Error("Failed to create instance of " + cls.forObjectType().getFullName(),e);
    object=NakedObjects.getObjectLoader().createAdapterForTransient(error);
    System.out.println("Failed to create instance of " + cls.forObjectType().getFullName());
    e.printStackTrace();
  }
  return object;
}
