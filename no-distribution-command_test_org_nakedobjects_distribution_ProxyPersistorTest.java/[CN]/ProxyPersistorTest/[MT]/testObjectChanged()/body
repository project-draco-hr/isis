{
  TestObjectBuilder referencedObject;
  referencedObject=new TestObjectBuilder(new TestPojo());
  referencedObject.setResolveState(ResolveState.RESOLVED);
  referencedObject.setOid(new DummyOid(23));
  TestValue value=new TestValue(new TestPojoValuePeer());
  TestObjectBuilder obj;
  obj=new TestObjectBuilder(new TestPojo());
  obj.setResolveState(ResolveState.RESOLVED);
  obj.setOid(new DummyOid(56));
  obj.setValueField("value",value);
  obj.setReferenceField("reference",referencedObject);
  ObjectData[] expectedChanges=new ObjectData[]{new DummyObjectData(new DummyOid(56),TestPojo.class.getName(),true,new DummyVersion())};
  distributionControl.expectAndReturn(distribution.executeClientAction(null,new ObjectData[0],expectedChanges,new ObjectData[0]),new ObjectData[0]);
  distributionControl.replay();
  NakedObject object=obj.getAdapter();
  persistor.startTransaction();
  persistor.objectChanged(object);
  persistor.endTransaction();
  distributionControl.verify();
}
