{
  BasicConfigurator.configure();
  LogManager.getRootLogger().setLevel(Level.DEBUG);
  persistor=new ProxyPersistor();
  distributionControl=MockControl.createControl(Distribution.class);
  distributionControl.setDefaultMatcher(MockControl.ARRAY_MATCHER);
  distribution=(Distribution)distributionControl.getMock();
  persistor.setConnection(distribution);
  ObjectEncoder encoder=new ObjectEncoder();
  encoder.setDataFactory(new DummyObjectDataFactory());
  persistor.setEncoder(encoder);
  persistor.setUpdateNotifier(new NullDirtyObjectSet());
  session=new NullSession();
  NakedObjectsClient nakedObjects=new NakedObjectsClient();
  loader=new ObjectLoaderImpl();
  loader.setAdapterFactory(new TestAdapterFactory());
  loader.setObjectFactory(new TestObjectFactory());
  nakedObjects.setObjectLoader(loader);
  nakedObjects.setConfiguration(new TestConfiguration());
  nakedObjects.setSpecificationLoader(new TestSpecificationLoader());
  nakedObjects.setObjectPersistor(persistor);
  nakedObjects.setSession(session);
  nakedObjects.init();
}
