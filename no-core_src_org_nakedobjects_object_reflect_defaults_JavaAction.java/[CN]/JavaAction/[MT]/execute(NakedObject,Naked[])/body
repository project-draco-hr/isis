{
  if (parameters.length != paramCount) {
    LOG.error(actionMethod + " requires " + paramCount+ " parameters, not "+ parameters.length);
  }
  NakedObjectManager objectManager=inObject.getContext().getObjectManager();
  try {
    LOG.debug("Action: invoke " + inObject + "."+ getName());
    objectManager.startTransaction();
    Object result;
    if (inObject.getOid() == null || !requiresTransaction()) {
      result=actionMethod.invoke(inObject,parameters);
    }
 else {
      NakedObject transactionObject=objectManager.getObject(inObject.getOid(),inObject.getSpecification());
      Naked[] transactionParameters=new Naked[parameters.length];
      for (int i=0; i < parameters.length; i++) {
        if (parameters[i] instanceof NakedObject) {
          NakedObject parameter=(NakedObject)parameters[i];
          transactionParameters[i]=objectManager.getObject(parameter.getOid(),parameter.getSpecification());
        }
 else {
          transactionParameters[i]=parameters[i];
        }
      }
      result=actionMethod.invoke(transactionObject,transactionParameters);
    }
    LOG.debug(" action result " + result);
    objectManager.endTransaction();
    if (result != null && result instanceof NakedObject) {
      return (NakedObject)result;
    }
  }
 catch (  InvocationTargetException e) {
    e.fillInStackTrace();
    if (e.getTargetException() instanceof TransactionException) {
      objectManager.abortTransaction();
      if (JavaReflector.isStrict()) {
        new ReflectionErrorDialog("Exception whilst reflectively getting about for " + getName() + " on "+ inObject,e);
        throw new NakedObjectRuntimeException("Exception whilst reflectively getting about for " + getName() + " on "+ inObject,e);
      }
 else {
        LOG.info("TransactionException thrown while executing " + actionMethod + " "+ e.getTargetException().getMessage());
      }
    }
 else {
      invocationException("Exception executing " + actionMethod + "; aborted",e);
    }
  }
catch (  IllegalAccessException e) {
    LOG.error("Illegal access of " + actionMethod,e);
    objectManager.abortTransaction();
  }
catch (  ObjectNotFoundException e) {
    LOG.error("Non-existing target or parameter used in " + actionMethod,e);
    objectManager.abortTransaction();
  }
  return null;
}
