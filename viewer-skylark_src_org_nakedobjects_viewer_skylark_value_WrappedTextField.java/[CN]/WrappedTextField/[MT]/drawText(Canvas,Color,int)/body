{
  int baseline=getBaseline();
  String[] lines=textContent.getDisplayLines();
  int cursorLine=cursor.getLine() - textContent.getDisplayFromLine();
  for (int i=0; i < lines.length; i++) {
    String chars=lines[i];
    if (chars == null) {
      throw new NakedObjectRuntimeException();
    }
    if (chars.endsWith("\n")) {
      throw new RuntimeException();
    }
    if (hasFocus() && canChangeValue() && cursorLine == i) {
      int at=Math.min(cursor.getCharacter(),chars.length());
      int pos=style.stringWidth(chars.substring(0,at));
      canvas.drawLine(pos + (HPADDING),(baseline + style.getDescent()),pos + (HPADDING),baseline - style.getAscent(),Style.PRIMARY1);
    }
    canvas.drawText(chars,HPADDING,baseline,textColor,style);
    baseline+=getText().getLineHeight();
  }
}
