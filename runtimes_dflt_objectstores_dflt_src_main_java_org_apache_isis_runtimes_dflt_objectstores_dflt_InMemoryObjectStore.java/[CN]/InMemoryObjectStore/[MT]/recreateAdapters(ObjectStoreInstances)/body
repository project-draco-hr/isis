{
  for (  Oid oid : objectStoreInstances.getOids()) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("recreating adapter: oid=" + oid);
    }
    Object pojo=objectStoreInstances.getPojo(oid);
    ObjectAdapter existingAdapterLookedUpByPojo=getAdapterManager().getAdapterFor(pojo);
    if (existingAdapterLookedUpByPojo != null) {
      getAdapterManager().removeAdapter(existingAdapterLookedUpByPojo);
    }
    ObjectAdapter existingAdapterLookedUpByOid=getAdapterManager().getAdapterFor(oid);
    if (existingAdapterLookedUpByOid != null) {
      throw new IsisException("A mapping already exists for " + oid + ": "+ existingAdapterLookedUpByOid);
    }
    ObjectAdapter recreatedAdapter=getHydrator().recreateAdapter(oid,pojo);
    Version version=objectStoreInstances.getVersion(oid);
    recreatedAdapter.setOptimisticLock(version);
  }
}
