{
  Thread key=Thread.currentThread();
  Stack stack=(Stack)ht.get(key);
  if (stack == null) {
    DiagnosticContext dc=new DiagnosticContext(message,null);
    stack=new Stack();
    ht.put(key,stack);
    stack.push(dc);
  }
 else   if (stack.isEmpty()) {
    DiagnosticContext dc=new DiagnosticContext(message,null);
    stack.push(dc);
  }
 else {
    DiagnosticContext parent=(DiagnosticContext)stack.peek();
    stack.push(new DiagnosticContext(message,parent));
  }
}
