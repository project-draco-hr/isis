{
  final DatabaseConnector db=connectionPool.acquire();
  try {
    final String tableName=Sql.tableIdentifier(TABLE_NAME);
    final String numberColumn=Sql.identifier(NUMBER_COLUMN);
    if (!db.hasTable(tableName)) {
      lastId=1;
      newBatchAt=BATCH_SIZE;
      db.update("create table " + tableName + " ("+ numberColumn+ " INTEGER)");
      db.update("insert into " + tableName + " values ("+ newBatchAt+ ")");
      LOG.debug("Initial ID batch created, from " + lastId + " to "+ newBatchAt);
    }
 else {
      if (db.update("update " + tableName + " set "+ numberColumn+ " = "+ numberColumn+ " + "+ BATCH_SIZE) != 1) {
        throw new SqlObjectStoreException("failed to update serial id table; no rows updated");
      }
      final Results rs=db.select("select " + numberColumn + " from "+ tableName);
      rs.next();
      newBatchAt=rs.getLong(NUMBER_COLUMN);
      lastId=newBatchAt - BATCH_SIZE;
      LOG.debug("New ID batch created, from " + lastId + " to "+ newBatchAt);
      rs.close();
    }
  }
 catch (  final ObjectPersistenceException e) {
    throw e;
  }
 finally {
    connectionPool.release(db);
  }
}
