{
  NakedObjectPersistenceManager objectManager=NakedObjects.getPersistenceManager();
  if (inObject.getResolveState().isPersistent()) {
    try {
      objectManager.startTransaction();
      super.setAssociation(identifier,inObject,associate);
      objectManager.saveChanges();
      objectManager.endTransaction();
    }
 catch (    RuntimeException e) {
      abort(objectManager);
      throw e;
    }
  }
 else {
    super.setAssociation(identifier,inObject,associate);
  }
}
