{
  ObjectAdapter collection;
  final String field=request.getOptionalProperty(FIELD);
  final RequestContext context=request.getContext();
  if (field != null) {
    final String id=request.getRequiredProperty(OBJECT);
    final ObjectAdapter object=context.getMappedObjectOrResult(id);
    final ObjectAssociation objectField=object.getSpecification().getAssociation(field);
    if (!objectField.isOneToManyAssociation()) {
      throw new ScimpiException("Field " + objectField.getId() + " is not a collection");
    }
    collection=objectField.get(object);
  }
 else {
    final String id=request.getOptionalProperty(COLLECTION);
    collection=context.getMappedObjectOrResult(id);
  }
  final ObjectSpecification elementSpecification=collection.getElementSpecification();
  final String name=elementSpecification.getSingularName();
  request.appendAsHtmlEncoded(name);
}
