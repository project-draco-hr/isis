{
  JavaBusinessObjectContainer container=new JavaBusinessObjectContainer();
  JavaObjectFactory objectFactory=new JavaObjectFactory();
  objectFactory.setContainer(container);
  TransientObjectStore objectStore=new TransientObjectStore();
  OidGenerator oidGenerator=new TimeBasedOidGenerator();
  DefaultPersistAlgorithm persistAlgorithm=new DefaultPersistAlgorithm();
  persistAlgorithm.setOidGenerator(oidGenerator);
  LocalObjectManager objectManager=new LocalObjectManager();
  objectManager.setObjectStore(objectStore);
  objectManager.setPersistAlgorithm(persistAlgorithm);
  nakedObjects.setObjectManager(objectManager);
  ReflectionPeerFactory[] factories=new ReflectionPeerFactory[]{new TransactionPeerFactory()};
  JavaSpecificationLoader specificationLoader=new JavaSpecificationLoader();
  specificationLoader.setReflectionPeerBuilder(factories);
  nakedObjects.setSpecificationLoader(specificationLoader);
  ObjectLoaderImpl objectLoader=new ObjectLoaderImpl();
  nakedObjects.setObjectLoader(objectLoader);
  objectLoader.setObjectFactory(objectFactory);
  objectLoader.setPojoAdapterMap(new PojoAdapterHashMap());
  objectLoader.setIdentityAdapterMap(new IdentityAdapterHashMap());
  objectLoader.setAdapterFactory(new JavaAdapterFactory());
  objectManager.init();
}
