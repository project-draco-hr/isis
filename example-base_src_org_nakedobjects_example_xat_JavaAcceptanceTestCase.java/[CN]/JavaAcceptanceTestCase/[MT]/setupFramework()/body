{
  JavaBusinessObjectContainer container=new JavaBusinessObjectContainer();
  NakedObjectsClient nakedObjects=new NakedObjectsClient();
  JavaObjectFactory objectFactory=new JavaObjectFactory();
  objectFactory.setContainer(container);
  container.setObjectFactory(objectFactory);
  TransientObjectStore objectStore=new TransientObjectStore();
  OidGenerator oidGenerator=new TimeBasedOidGenerator();
  LocalObjectManager objectManager=new LocalObjectManager();
  objectManager.setObjectStore(objectStore);
  objectManager.setObjectFactory(objectFactory);
  objectManager.setOidGenerator(oidGenerator);
  nakedObjects.setObjectManager(objectManager);
  NakedObjectSpecificationLoaderImpl specificationLoader=new NakedObjectSpecificationLoaderImpl();
  nakedObjects.setSpecificationLoader(specificationLoader);
  LocalReflectionFactory reflectionFactory=new LocalReflectionFactory();
  JavaReflectorFactory reflectorFactory=new JavaReflectorFactory();
  PojoAdapterFactoryImpl pojoAdapterFactory=new PojoAdapterFactoryImpl();
  pojoAdapterFactory.setPojoAdapterHash(new PojoAdapterHashImpl());
  pojoAdapterFactory.setReflectorFactory(reflectorFactory);
  nakedObjects.setPojoAdapterFactory(pojoAdapterFactory);
  NakedObjectSpecificationImpl.setReflectionFactory(reflectionFactory);
  specificationLoader.setReflectorFactory(reflectorFactory);
  reflectorFactory.setObjectFactory(objectFactory);
  try {
    objectManager.init();
  }
 catch (  StartupException e) {
    throw new NakedObjectRuntimeException(e);
  }
  Runtime.getRuntime().gc();
}
