{
  final String cls=member.toIdentityString(Identifier.CLASS);
  final String name=member.toIdentityString(Identifier.MEMBERNAME_ONLY);
  final String parms=member.toIdentityString(Identifier.PARAMETERS_ONLY);
  final Object[] args=new Object[]{role,cls,name,parms};
  final SearchControls controls=new SearchControls();
  controls.setSearchScope(SearchControls.SUBTREE_SCOPE);
  final String searchName=buildSearchName(cls,appDn);
  final NamingEnumeration<SearchResult> answer=authContext.search(searchName,FILTER,args,controls);
  while (answer.hasMore()) {
    final SearchResult result=answer.nextElement();
    final String cn=(String)result.getAttributes().get("cn").get(0);
    if (cn.equals(cls) || cn.equals(name) || ((cn.equals(parms) && result.getName().contains(name)))) {
      if (flag != null) {
        final Attribute flagAttribute=result.getAttributes().get("flag");
        if (flagAttribute != null) {
          return flag.equalsIgnoreCase((String)flagAttribute.get(0));
        }
      }
      return true;
    }
  }
  return false;
}
