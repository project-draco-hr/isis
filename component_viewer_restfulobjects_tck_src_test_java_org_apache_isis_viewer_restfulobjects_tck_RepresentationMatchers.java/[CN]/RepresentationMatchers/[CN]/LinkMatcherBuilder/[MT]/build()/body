{
  return new TypeSafeMatcher<JsonRepresentation>(){
    @Override public void describeTo(    final Description description){
      description.appendText("a link");
      if (rel != null) {
        description.appendText(" with rel '").appendText(rel).appendText("'");
      }
      if (href != null) {
        description.appendText(" with href '").appendText(href).appendText("'");
      }
      if (hrefMatcher != null) {
        description.appendText(" with href ");
        hrefMatcher.describeTo(description);
      }
      if (httpMethod != null) {
        description.appendText(" with method '").appendValue(httpMethod).appendText("'");
      }
      if (mediaType != null) {
        description.appendText(" with type '").appendValue(mediaType).appendText("'");
      }
      if (typeParameterName != null) {
        description.appendText(" with media type parameter '").appendText(typeParameterName).appendText("=").appendText(typeParameterValue).appendText("'");
      }
      if (novalue != null && novalue) {
        description.appendText(" with no value");
      }
      if (valueMatcher != null) {
        description.appendText(" with value ");
        valueMatcher.describeTo(description);
      }
      if (statusCode != null || selfHref != null) {
        if (client == null) {
          throw new IllegalStateException("require client in order to assert on statusCode");
        }
        description.appendText(" that when followed");
        if (statusCode != null) {
          description.appendText(" returns status " + statusCode);
        }
        if (statusCode != null || selfHref != null) {
          description.appendText(" and");
        }
        if (selfHref != null) {
          description.appendText(" an response whose self.href is " + selfHref);
        }
      }
    }
    @Override public boolean matchesSafely(    final JsonRepresentation linkRepr){
      if (linkRepr == null) {
        return false;
      }
      final LinkRepresentation link=linkRepr.asLink();
      if (rel != null && !rel.equals(link.getRel())) {
        return false;
      }
      if (relNameMatcher != null && !relNameMatcher.matches(link.getHref())) {
        return false;
      }
      if (href != null && !href.equals(link.getHref())) {
        return false;
      }
      if (hrefMatcher != null && !hrefMatcher.matches(link.getHref())) {
        return false;
      }
      if (httpMethod != null && !httpMethod.equals(link.getHttpMethod())) {
        return false;
      }
      if (mediaType != null && !mediaType.isCompatible(mediaType)) {
        return false;
      }
      if (typeParameterName != null) {
        final MediaType mediaType=link.getType();
        final String parameterValue=mediaType.getParameters().get(typeParameterName);
        if (!typeParameterValue.equals(parameterValue)) {
          return false;
        }
      }
      if (novalue != null && novalue && link.getValue() != null) {
        return false;
      }
      if (valueMatcher != null && !valueMatcher.matches(link)) {
        return false;
      }
      RestfulResponse<JsonRepresentation> jsonResp=null;
      if (statusCode != null || selfHref != null) {
        if (client == null) {
          return false;
        }
        try {
          jsonResp=client.followT(link);
        }
 catch (        final Exception e) {
          throw new RuntimeException(e);
        }
      }
      if (statusCode != null) {
        if (jsonResp.getStatus() != statusCode) {
          return false;
        }
      }
      if (selfHref != null) {
        JsonRepresentation entity;
        try {
          entity=jsonResp.getEntity();
        }
 catch (        Exception e) {
          return false;
        }
        if (entity == null) {
          return false;
        }
        LinkRepresentation selfLink=entity.getLink("self");
        if (selfLink == null) {
          return false;
        }
        if (!selfLink.getHref().equals(selfHref)) {
          return false;
        }
      }
      return true;
    }
  }
;
}
