{
  List<ObjectActionParameter> parameters=action.getParameters();
  for (int i=0; i < parameters.size(); i++) {
    ObjectActionParameter parameter=parameters.get(i);
    ObjectAdapter paramAdapter=argAdapters.get(i);
    if (paramAdapter.getSpecification().containsFacet(ValueFacet.class)) {
      Object arg=paramAdapter.getObject();
      String reasonNotValid=parameter.isValid(objectAdapter,arg);
      if (reasonNotValid != null) {
        throw new WebApplicationException(responseOfPreconditionFailed(reasonNotValid));
      }
    }
  }
  ObjectAdapter[] argArray=argAdapters.toArray(new ObjectAdapter[0]);
  Consent consent=action.isProposedArgumentSetValid(objectAdapter,argArray);
  if (consent.isVetoed()) {
    throw new WebApplicationException(responseOfPreconditionFailed(consent.getReason()));
  }
  final ObjectAdapter returnedAdapter=action.execute(objectAdapter,argArray);
  if (returnedAdapter == null) {
    return responseOfOk();
  }
  final CollectionFacet facet=returnedAdapter.getSpecification().getFacet(CollectionFacet.class);
  if (facet != null) {
    final Collection<ObjectAdapter> collectionAdapters=facet.collection(returnedAdapter);
    return responseOfOk(jsonRepresentationOf(collectionAdapters));
  }
 else {
    return responseOfOk(jsonRepresentationOf(returnedAdapter));
  }
}
