{
  final PersistenceSession persistenceSession=persistenceSessionFactory.createPersistenceSession();
  ensureThatArg(persistenceSession,is(not(nullValue())));
  final UserProfile userProfile=userProfileLoader.getProfile(authenticationSession);
  ensureThatArg(userProfile,is(not(nullValue())));
  getSpecificationLoader().injectInto(persistenceSession);
  final IsisSessionDefault isisSessionDefault=new IsisSessionDefault(this,authenticationSession,persistenceSession,userProfile);
  return isisSessionDefault;
}
