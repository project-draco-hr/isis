{
  if (transactionMode == TransactionMode.UNCHAINED) {
    ensureThatContext(IsisContext.inTransaction(),is(true));
    ensureInHibernateTransaction();
  }
 else {
    ensureInSession();
    if (IsisContext.inTransaction()) {
      ensureInHibernateTransaction();
    }
 else {
      getTransactionManager().startTransaction();
    }
  }
}
