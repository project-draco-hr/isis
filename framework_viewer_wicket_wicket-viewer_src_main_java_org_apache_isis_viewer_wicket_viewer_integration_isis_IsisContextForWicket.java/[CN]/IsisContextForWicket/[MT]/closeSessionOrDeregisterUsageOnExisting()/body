{
  final AuthenticatedWebSessionForIsis webSession=(AuthenticatedWebSessionForIsis)Session.get();
  final boolean shouldClose=webSession.deregisterUseByThread();
  final IsisSession isisSession=sessionMap.get(webSession);
  if (isisSession == null) {
    return;
  }
  if (shouldClose) {
    isisSession.close();
    sessionMap.remove(webSession);
  }
}
