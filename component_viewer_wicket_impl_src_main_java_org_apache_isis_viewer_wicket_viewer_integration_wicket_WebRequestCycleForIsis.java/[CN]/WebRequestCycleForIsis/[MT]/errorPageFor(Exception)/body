{
  List<ExceptionRecognizer> exceptionRecognizers=Collections.emptyList();
  if (inIsisSession()) {
    exceptionRecognizers=getServicesInjector().lookupServices(ExceptionRecognizer.class);
  }
 else {
    LOG.warn("Unable to obtain exceptionRecognizers (no session), will be treated as unrecognized exception");
  }
  String recognizedMessageIfAny=new ExceptionRecognizerComposite(exceptionRecognizers).recognize(ex);
  ExceptionModel exceptionModel=ExceptionModel.create(recognizedMessageIfAny,ex);
  if (isSignedIn()) {
    return new ErrorPage(exceptionModel);
  }
 else {
    return new WicketSignInPage(null,exceptionModel);
  }
}
