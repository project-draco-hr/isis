{
  NakedObject[] instances=new NakedObject[45];
  int i=0;
  String query="select * from person";
  Statement s=connection.createStatement();
  ResultSet rs=s.executeQuery(query);
  while (rs.next() && i < instances.length) {
    Oid oid=new SqlOid(rs.getInt(1));
    Person person;
    if (NakedObjects.getObjectLoader().isIdentityKnown(oid)) {
      instances[i++]=NakedObjects.getObjectLoader().getAdapterFor(oid);
      person=(Person)NakedObjects.getObjectLoader().getAdapterFor(oid).getObject();
    }
 else {
      person=new Person();
      person.setName(rs.getString(2));
      instances[i++]=NakedObjects.getObjectLoader().recreateAdapterForPersistent(oid,person);
    }
  }
  rs.close();
  s.close();
  NakedObject[] results=new NakedObject[i];
  System.arraycopy(instances,0,results,0,i);
  return results;
}
