{
  for (  final Oid oid : objectStoreInstances.getOids()) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("recreating adapter: oid=" + oid);
    }
    final Object pojo=objectStoreInstances.getPojo(oid);
    final ObjectAdapter existingAdapterLookedUpByPojo=getAdapterManager().getAdapterFor(pojo);
    if (existingAdapterLookedUpByPojo != null) {
      getAdapterManager().removeAdapter(existingAdapterLookedUpByPojo);
    }
    final ObjectAdapter existingAdapterLookedUpByOid=getAdapterManager().getAdapterFor(oid);
    if (existingAdapterLookedUpByOid != null) {
      throw new IsisException("A mapping already exists for " + oid + ": "+ existingAdapterLookedUpByOid);
    }
    final ObjectAdapter recreatedAdapter=getAdapterManager().mapRecreatedPojo(oid,pojo);
    final Version version=objectStoreInstances.getVersion(oid);
    recreatedAdapter.setVersion(version);
  }
}
