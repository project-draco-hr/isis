{
  try {
    socket=new Socket(host,port);
    socket.setSoTimeout(timeout);
    outputStream=socket.getOutputStream();
    outputStream=Util.trace(outputStream,true);
    writer=new PrintWriter(new OutputStreamWriter(outputStream,Util.ENCODING));
    inputStream=socket.getInputStream();
    inputStream=Util.trace(inputStream,true);
    reader=new BufferedReader(new InputStreamReader(inputStream,Util.ENCODING));
  }
 catch (  UnknownHostException e) {
    throw new NoSqlStoreException("Unknow host " + host,e);
  }
catch (  IOException e) {
    throw new NoSqlStoreException("Failed to connect to " + host + ":"+ port,e);
  }
}
