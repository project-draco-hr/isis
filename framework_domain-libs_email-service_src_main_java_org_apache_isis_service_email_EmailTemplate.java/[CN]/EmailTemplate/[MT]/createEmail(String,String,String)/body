{
  init();
  StringWriter writer=new StringWriter();
  try {
    Template t=ve.getTemplate(templatePath);
    t.merge(context,writer);
  }
 catch (  Exception e) {
    throw new ApplicationException(e);
  }
  Email email=newTransientInstance(Email.class);
  email.setSubject(subject);
  email.setMessage(writer.toString());
  Address address=newTransientInstance(Address.class);
  address.setEmailAddress(emailAddress);
  email.addToTo(address);
  return email;
}
