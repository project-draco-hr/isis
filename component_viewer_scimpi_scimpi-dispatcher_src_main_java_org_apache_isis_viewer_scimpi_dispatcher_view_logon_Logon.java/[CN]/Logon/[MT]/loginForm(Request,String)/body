{
  final String object=request.getOptionalProperty(OBJECT);
  final String method=request.getOptionalProperty(METHOD,"logon");
  final String result=request.getOptionalProperty(RESULT_NAME,"_user");
  final String resultScope=request.getOptionalProperty(SCOPE,Scope.SESSION.name());
  final String isisUser=request.getOptionalProperty("isis-user","_web_default");
  final String formId=request.getOptionalProperty(FORM_ID,request.nextFormId());
  final String labelDelimiter=request.getOptionalProperty(LABEL_DELIMITER,":");
  if (object != null) {
    RequestContext context=request.getContext();
    context.addVariable(LOGON_OBJECT,object,Scope.SESSION);
    context.addVariable(LOGON_METHOD,method,Scope.SESSION);
    context.addVariable(LOGON_RESULT_NAME,result,Scope.SESSION);
    context.addVariable(LOGON_SCOPE,resultScope,Scope.SESSION);
    context.addVariable(PREFIX + "isis-user",isisUser,Scope.SESSION);
    context.addVariable(LOGON_FORM_ID,formId,Scope.SESSION);
  }
  final String error=request.getOptionalProperty(ERROR,request.getContext().getRequestedFile());
  final List<HiddenInputField> hiddenFields=new ArrayList<HiddenInputField>();
  hiddenFields.add(new HiddenInputField(ERROR,error));
  if (view != null) {
    hiddenFields.add(new HiddenInputField(VIEW,view));
  }
  hiddenFields.add(new HiddenInputField("_" + FORM_ID,formId));
  final FormState entryState=(FormState)request.getContext().getVariable(ENTRY_FIELDS);
  boolean isforThisForm=entryState != null && entryState.isForForm(formId);
  if (entryState != null && entryState.isForForm(formId)) {
  }
  final InputField nameField=createdField("username","User Name",InputField.TEXT,isforThisForm ? entryState : null);
  final String width=request.getOptionalProperty("width");
  if (width != null) {
    final int w=Integer.valueOf(width).intValue();
    nameField.setWidth(w);
  }
  final InputField passwordField=createdField("password","Password",InputField.PASSWORD,isforThisForm ? entryState : null);
  final InputField[] fields=new InputField[]{nameField,passwordField};
  final String formTitle=request.getOptionalProperty(FORM_TITLE);
  final String loginButtonTitle=request.getOptionalProperty(BUTTON_TITLE,"Log in");
  final String className=request.getOptionalProperty(CLASS,"login");
  final String id=request.getOptionalProperty(ID,"logon");
  HtmlFormBuilder.createForm(request,"logon.app",hiddenFields.toArray(new HiddenInputField[hiddenFields.size()]),fields,className,id,formTitle,labelDelimiter,null,null,loginButtonTitle,isforThisForm && entryState != null ? entryState.getError() : null,null);
}
