{
  final CommandContext commandContext=getServiceOrNull(CommandContext.class);
  if (commandContext == null) {
    return;
  }
  final Command command=commandContext.getCommand();
  if (command == null) {
    return;
  }
  final Set<ObjectAdapter> changedAdapters=findChangedAdapters(changedObjectProperties);
  if (!changedAdapters.isEmpty()) {
    command.setPersistHint(true);
  }
  ensureSafeSemanticsHonoured(command,changedAdapters);
}
