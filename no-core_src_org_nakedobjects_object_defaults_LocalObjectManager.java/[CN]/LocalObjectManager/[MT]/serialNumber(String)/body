{
  LOG.debug("serialNumber " + sequence);
  try {
    NakedObject[] instances=objectStore.getInstances(NakedObjectSpecificationLoader.getInstance().loadSpecification(Sequence.class.getName()),false);
    Sequence number;
    for (int i=0, len=instances.length; i < len; i++) {
      number=(Sequence)instances[i];
      if (number.getName().isSameAs(sequence)) {
        number=(Sequence)instances[i];
        number.getSerialNumber().next();
        objectStore.save(number);
        return number.getSerialNumber().longValue();
      }
    }
    number=new Sequence();
    number.created();
    number.getName().setValue(sequence);
    makePersistent(number);
    return number.getSerialNumber().longValue();
  }
 catch (  ObjectStoreException e) {
    throw new NakedObjectRuntimeException(e);
  }
}
