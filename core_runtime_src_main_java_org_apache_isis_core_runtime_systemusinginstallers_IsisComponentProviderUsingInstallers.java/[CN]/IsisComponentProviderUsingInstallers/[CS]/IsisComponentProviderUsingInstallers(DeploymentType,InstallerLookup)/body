{
  super(deploymentType,globSpecIfAny(installerLookup));
  ensureThatArg(deploymentType,is(not(nullValue())));
  ensureThatArg(installerLookup,is(not(nullValue())));
  this.installerLookup=installerLookup;
  if (globSpec != null) {
    specifyServicesAndRegisteredEntitiesUsing(globSpec);
    putConfigurationProperty(SystemConstants.SERVICES_INSTALLER_KEY,ServicesInstallerFromAnnotation.NAME);
    final String authenticationMechanism=globSpec.getAuthenticationMechanism();
    putConfigurationProperty(SystemConstants.AUTHENTICATION_INSTALLER_KEY,authenticationMechanism);
    final String authorizationMechanism=globSpec.getAuthorizationMechanism();
    putConfigurationProperty(SystemConstants.AUTHORIZATION_INSTALLER_KEY,authorizationMechanism);
    specifyFixtureScriptsUsing(globSpec);
    overrideConfigurationUsing(globSpec);
  }
  AuthenticationManagerInstaller authenticationInstaller=this.installerLookup.authenticationManagerInstaller(configProperty(SystemConstants.AUTHENTICATION_INSTALLER_KEY));
  AuthorizationManagerInstaller authorizationInstaller=this.installerLookup.authorizationManagerInstaller(configProperty(SystemConstants.AUTHORIZATION_INSTALLER_KEY));
  this.fixturesInstaller=this.installerLookup.fixturesInstaller(configProperty(SystemConstants.FIXTURES_INSTALLER_KEY));
  ServicesInstaller servicesInstaller=this.installerLookup.servicesInstaller(null);
  persistenceMechanismInstaller=this.installerLookup.persistenceMechanismInstaller(configProperty(SystemConstants.OBJECT_PERSISTOR_INSTALLER_KEY));
  reflectorInstaller=this.installerLookup.reflectorInstaller(configProperty(SystemConstants.REFLECTOR_KEY));
  TransactionFacetDecoratorInstaller transactionFacetDecoratorInstaller=this.installerLookup.getInstaller(TransactionFacetDecoratorInstaller.class);
  ensureThatState(authenticationInstaller,is(not(nullValue())),"authenticationInstaller could not be looked up");
  ensureThatState(authorizationInstaller,is(not(nullValue())),"authorizationInstaller could not be looked up");
  ensureThatState(servicesInstaller,is(not(nullValue())),"servicesInstaller could not be looked up");
  ensureThatState(fixturesInstaller,is(not(nullValue())),"fixtureInstaller could not be looked up");
  ensureThatState(transactionFacetDecoratorInstaller,is(not(nullValue())),"transactionFacetDecoratorInstaller could not be looked up");
  ensureThatState(persistenceMechanismInstaller,is(not(nullValue())),"persistenceMechanismInstaller could not be looked up");
  ensureThatState(reflectorInstaller,is(not(nullValue())),"reflectorInstaller could not be looked up");
  reflectorInstaller.addFacetDecoratorInstaller(transactionFacetDecoratorInstaller);
  configuration=this.installerLookup.getConfiguration();
  authenticationManager=authenticationInstaller.createAuthenticationManager();
  authorizationManager=authorizationInstaller.createAuthorizationManager();
  services=servicesInstaller.getServices();
  ensureInitialized();
}
