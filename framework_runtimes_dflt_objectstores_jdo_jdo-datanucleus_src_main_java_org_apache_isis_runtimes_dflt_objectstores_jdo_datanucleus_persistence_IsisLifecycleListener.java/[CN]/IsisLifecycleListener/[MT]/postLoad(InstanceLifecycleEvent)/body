{
  if (LOG.isDebugEnabled()) {
    LOG.debug(logString(Phase.POST,event));
  }
  if (isSuspended()) {
    LOG.debug(" [currently suspended - ignoring]");
    return;
  }
  final PersistenceCapable pojo=persistenceCapableFor(event);
  final RootOid oid;
  ObjectAdapter existingAdapterIfAny=getAdapterManager().getAdapterFor(pojo);
  if (existingAdapterIfAny != null) {
    ensureRootObject(event);
    oid=(RootOid)existingAdapterIfAny.getOid();
  }
 else {
    final OidGenerator oidGenerator=getOidGenerator();
    oid=oidGenerator.createPersistent(pojo,null);
    existingAdapterIfAny=getAdapterManager().getAdapterFor(oid);
    if (existingAdapterIfAny != null) {
      getAdapterManager().removeAdapter(existingAdapterIfAny);
      existingAdapterIfAny.replacePojo(pojo);
      getAdapterManager().addExistingAdapter(existingAdapterIfAny);
    }
 else {
      PersistenceSessionHydrator hydrator=getPersistenceSession();
      ObjectAdapter adapter=hydrator.recreateAdapter(oid,pojo);
      PersistorUtil.startResolving(adapter);
      PersistorUtil.endResolving(adapter);
    }
  }
  ensureFrameworksInAgreement(event);
}
