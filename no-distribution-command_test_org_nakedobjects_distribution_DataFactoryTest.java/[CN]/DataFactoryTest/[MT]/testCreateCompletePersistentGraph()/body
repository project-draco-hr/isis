{
  DummyOid rootOid=new DummyOid(1);
  rootObject.setupOid(rootOid);
  DummyOid referencedOid=new DummyOid(1);
  field1.setupOid(referencedOid);
  DummyOid referencedOid2=new DummyOid(1);
  field1_1.setupOid(referencedOid2);
  ObjectData rootData=(ObjectData)encoder.createCompletePersistentGraph(rootObject);
  assertEquals(ResolveState.RESOLVED,rootObject.getResolveState());
  assertEquals(rootOid,rootData.getOid());
  assertEquals(rootSpecification.getFullName(),rootData.getType());
  assertEquals(new DummyVersion(11),rootData.getVersion());
  assertEquals(4,rootData.getFieldContent().length);
  ObjectData referencedFieldData=(ObjectData)rootData.getFieldContent()[0];
  assertEquals(referencedOid,referencedFieldData.getOid());
  assertEquals(1,referencedFieldData.getFieldContent().length);
  assertEquals(new DummyVersion(12),referencedFieldData.getVersion());
  assertEquals(field1Specification.getFullName(),referencedFieldData.getType());
  ObjectData referencedFieldData2=(ObjectData)referencedFieldData.getFieldContent()[0];
  assertEquals(referencedOid2,referencedFieldData2.getOid());
  assertEquals(1,referencedFieldData2.getFieldContent().length);
  assertEquals(new DummyVersion(13),referencedFieldData2.getVersion());
  assertEquals(field1Specification.getFullName(),referencedFieldData.getType());
  ValueData valueData=(ValueData)rootData.getFieldContent()[1];
  assertEquals(valueSpecification.getFullName(),valueData.getType());
  assertEquals(value,valueData.getValue());
  NullData emptyFieldData=(NullData)rootData.getFieldContent()[3];
  assertNotNull(emptyFieldData);
  CollectionData collectionData=(CollectionData)rootData.getFieldContent()[2];
  assertEquals(2,collectionData.getElements().length);
  ObjectData fieldOfField=(ObjectData)referencedFieldData2.getFieldContent()[0];
  assertSame(fieldOfField,rootData);
  ObjectData fieldOfElement=(ObjectData)collectionData.getElements()[0].getFieldContent()[0];
  assertSame(fieldOfElement,rootData);
}
