{
  DummyObjectData reference2=new DummyObjectData(null,"ref2",null,false,null);
  field1_1.setupResolveState(ResolveState.TRANSIENT);
  field1_1.setupOid(new DummyOid(192));
  DummyValueData value=new DummyValueData(null,"val");
  DummyObjectData el1=new DummyObjectData(null,"element1",null,false,null);
  element1.setupResolveState(ResolveState.TRANSIENT);
  element1.setupOid(new DummyOid(34));
  DummyObjectData el2=new DummyObjectData(null,"element2",null,false,null);
  element2.setupResolveState(ResolveState.TRANSIENT);
  element2.setupOid(new DummyOid(29));
  DummyObjectData reference1=new DummyObjectData(null,"ref1",new Data[]{reference2},false,null);
  field1.setupResolveState(ResolveState.TRANSIENT);
  field1.setupFields(field1Specification.getFields());
  field1.setupOid(new DummyOid(583));
  DummyCollectionData coll=new DummyCollectionData(null,"coll",new ObjectData[]{el1,el2},null);
  ObjectData data=new DummyObjectData(null,"root",new Data[]{reference1,value,coll,null},false,null);
  rootObject.setupResolveState(ResolveState.TRANSIENT);
  rootObject.setupFields(rootSpecification.getFields());
  rootObject.setupOid(new DummyOid(712));
  ObjectData updates=factory.createMadePersistentGraph(data,rootObject,new SingleResponseUpdateNotifier());
  assertEquals(new DummyOid(712),updates.getOid());
  assertEquals(new DummyVersion(11),updates.getVersion());
  assertEquals(4,updates.getFieldContent().length);
  ObjectData field1=(ObjectData)updates.getFieldContent()[0];
  assertEquals("ref1",field1.getType());
  assertEquals(new DummyOid(583),field1.getOid());
  assertEquals(new DummyVersion(12),field1.getVersion());
  assertEquals(1,field1.getFieldContent().length);
  Data field2=updates.getFieldContent()[1];
  assertEquals(null,field2);
  CollectionData field3=(CollectionData)updates.getFieldContent()[2];
  assertNotNull(field3);
  assertEquals("coll",field3.getType());
  assertEquals(null,field3.getOid());
  assertEquals(new DummyVersion(27),field3.getVersion());
  assertEquals(2,field3.getElements().length);
  Data field4=updates.getFieldContent()[3];
  assertEquals(null,field4);
  ObjectData field=(ObjectData)field1.getFieldContent()[0];
  assertEquals("ref2",field.getType());
  assertEquals(new DummyOid(192),field.getOid());
  assertEquals(new DummyVersion(13),field.getVersion());
  ObjectData element1=(ObjectData)field3.getElements()[0];
  assertEquals("element1",element1.getType());
  assertEquals(new DummyOid(34),element1.getOid());
  assertEquals(new DummyVersion(17),element1.getVersion());
  ObjectData element2=(ObjectData)field3.getElements()[1];
  assertEquals("element2",element2.getType());
  assertEquals(new DummyOid(29),element2.getOid());
  assertEquals(new DummyVersion(19),element2.getVersion());
}
