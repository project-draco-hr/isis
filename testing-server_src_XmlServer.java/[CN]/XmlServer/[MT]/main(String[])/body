{
  BasicConfigurator.configure();
  NakedObjectsClient nakedObjects=new NakedObjectsClient();
  Configuration configuration=new Configuration(new ConfigurationPropertiesLoader("server.properties",true));
  nakedObjects.setConfiguration(configuration);
  PropertyConfigurator.configure(configuration.getProperties("log4j"));
  JavaBusinessObjectContainer container=new JavaBusinessObjectContainer();
  new SystemClock();
  TransientObjectStore objectStore=new TransientObjectStore();
  DataFactory objectDataFactory=new JavaObjectDataFactory();
  SingleResponseUpdateNotifier updateNotifier=new SingleResponseUpdateNotifier();
  updateNotifier.setFactory(objectDataFactory);
  JavaObjectFactory objectFactory=new JavaObjectFactory();
  objectFactory.setContainer(container);
  OidGenerator oidGenerator=new SimpleOidGenerator();
  DefaultPersistAlgorithm persistAlgorithm=new DefaultPersistAlgorithm();
  persistAlgorithm.setOidGenerator(oidGenerator);
  LocalObjectManager objectManager=new LocalObjectManager();
  objectManager.setObjectStore(objectStore);
  objectManager.setPersistAlgorithm(persistAlgorithm);
  objectManager.setCheckObjectsForDirtyFlag(true);
  nakedObjects.setObjectManager(objectManager);
  LocalReflectionFactory reflectionFactory=new LocalReflectionFactory();
  nakedObjects.setReflectionFactory(reflectionFactory);
  JavaReflectorFactory reflectorFactory=new JavaReflectorFactory();
  nakedObjects.setReflectorFactory(reflectorFactory);
  ObjectLoaderImpl objectLoader=new ObjectLoaderImpl();
  objectLoader.setPojoAdapterMap(new PojoAdapterHashImpl());
  objectLoader.setObjectFactory(objectFactory);
  objectLoader.setIdentityAdapterMap(new IdentityAdapterMapImpl());
  nakedObjects.setObjectLoader(objectLoader);
  NakedObjectSpecificationLoaderImpl specificationLoader=new NakedObjectSpecificationLoaderImpl();
  nakedObjects.setSpecificationLoader(specificationLoader);
  ServerDistribution sd=new ServerDistribution();
  sd.setObjectFactory(objectFactory);
  sd.setObjectDataFactory(objectDataFactory);
  ServerListener serverListener=new ServerListener();
  serverListener.setUpdateNotifier(updateNotifier);
  serverListener.setServerDistribution(sd);
  objectManager.addObjectChangedListener(updateNotifier);
  nakedObjects.init();
  serverListener.start();
  JavaFixtureBuilder fb=new JavaFixtureBuilder();
  CitiesFixture cities;
  fb.addFixture(cities=new CitiesFixture());
  fb.addFixture(new BookingsFixture(cities));
  fb.addFixture(new ClassesFixture());
  fb.installFixtures();
  InfoDebugFrame debugFrame=new InfoDebugFrame(){
    public void dialogClosing(){
      System.exit(0);
    }
  }
;
  DebugInfo debugInfo=objectManager;
  debugFrame.setInfo(debugInfo);
  debugFrame.setBounds(10,10,1000,800);
  debugFrame.refresh();
  debugFrame.show();
}
