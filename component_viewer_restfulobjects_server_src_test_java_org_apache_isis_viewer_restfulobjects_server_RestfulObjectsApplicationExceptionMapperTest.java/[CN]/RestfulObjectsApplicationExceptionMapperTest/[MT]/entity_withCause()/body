{
  final Exception cause=new Exception("barfoo");
  final RestfulObjectsApplicationException ex=RestfulObjectsApplicationException.createWithCauseAndMessage(HttpStatusCode.BAD_REQUEST,cause,"foobar");
  final Response response=exceptionMapper.toResponse(ex);
  final String entity=(String)response.getEntity();
  assertThat(entity,is(not(nullValue())));
  final JsonRepresentation jsonRepr=JsonMapper.instance().read(entity,JsonRepresentation.class);
  assertThat(jsonRepr.getString("message"),is(ex.getMessage()));
  final JsonRepresentation causedByRepr=jsonRepr.getRepresentation("causedBy");
  assertThat(causedByRepr,is(not(nullValue())));
  assertThat(causedByRepr.getString("message"),is(cause.getMessage()));
}
