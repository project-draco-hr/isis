{
  String type=data.getType();
  NakedObjectSpecification specification=NakedObjects.getSpecificationLoader().loadSpecification(type);
  NakedObjectLoader objectLoader=NakedObjects.getObjectLoader();
  NakedCollection collection;
  collection=objectLoader.recreateCollection(specification);
  if (data.getElements() == null) {
    LOG.debug("restoring empty collection");
    return collection;
  }
 else {
    ObjectData[] elements=data.getElements();
    LOG.debug("restoring collection " + elements.length + " elements");
    Object[] initData=new Object[elements.length];
    for (int i=0; i < elements.length; i++) {
      NakedObject element=restoreObject(elements[i],previous);
      LOG.debug("restoring collection element :" + element);
      initData[i]=element.getObject();
    }
    collection.init(initData);
    return collection;
  }
}
