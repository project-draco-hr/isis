{
  if (pojo == null) {
    return null;
  }
  PojoAdapter nakedObject;
  if (pojos.containsKey(pojo)) {
    nakedObject=(PojoAdapter)pojos.get(pojo);
  }
 else {
    if (pojo instanceof PojoAdapter) {
      throw new NakedObjectRuntimeException("Warning: adapter is wrapping an adapter: " + pojo);
    }
    nakedObject=new PojoAdapter(pojo);
  }
  if (oid != null) {
    if (nakedObject.getOid() == null) {
      nakedObject.setOid(oid);
    }
 else {
      if (!nakedObject.getOid().equals(oid)) {
        throw new NakedObjectRuntimeException("Different OID for same Pojo");
      }
    }
  }
  return nakedObject;
}
