{
  while (true) {
    try {
      String requestData=(String)input.readObject();
      LOG.debug("request received \n" + requestData);
      XStream xstream=new XStream();
      Request request=(Request)xstream.fromXML(requestData);
      LOG.debug("request received " + request);
      String responseData;
      try {
        request.execute(server);
        Response response;
        response=new Response(request);
        response.setUpdates(updateNotifier.getUpdates());
        LOG.debug("sending " + response);
        responseData=xstream.toXML(response);
      }
 catch (      Exception e) {
        LOG.debug("sending exception " + e);
        responseData=xstream.toXML(e);
      }
      LOG.debug("send response \n" + responseData);
      output.writeObject(responseData);
      output.flush();
    }
 catch (    SocketException e) {
      LOG.info("shutting down receiver (" + e + ")");
      break;
    }
catch (    IOException e) {
      LOG.info("connection exception; closing connection",e);
      break;
    }
catch (    ClassNotFoundException e) {
      LOG.error("unknown class received; closing connection: " + e.getMessage(),e);
      break;
    }
  }
}
