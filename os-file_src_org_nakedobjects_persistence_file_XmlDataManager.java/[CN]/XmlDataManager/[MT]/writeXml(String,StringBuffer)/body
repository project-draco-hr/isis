{
  OutputStreamWriter pw;
  try {
    pw=new OutputStreamWriter(new FileOutputStream(file(name)),charset);
    pw.write("<?xml version=\"1.0\" encoding=\"" + charset + "\" ?>\n");
    pw.write("\n");
    pw.write(buf.toString());
    pw.write("\n");
    pw.close();
  }
 catch (  IOException e) {
    throw new NakedObjectRuntimeException("Problems writing data files",e);
  }
}
