{
  try {
    final String line=reader.readLine();
    LOG.debug("header: " + line);
    if (line == null) {
      logFailure();
      throw new RemotingException("stream ended prematurely while reading header, aborting request");
    }
    if (line.length() == 0) {
      return false;
    }
 else {
      command=line.charAt(0);
      headers=line.substring(1).split(" ");
      this.header=0;
      return true;
    }
  }
 catch (  final IOException e) {
    logFailure();
    throw new NoSqlStoreException(e);
  }
}
