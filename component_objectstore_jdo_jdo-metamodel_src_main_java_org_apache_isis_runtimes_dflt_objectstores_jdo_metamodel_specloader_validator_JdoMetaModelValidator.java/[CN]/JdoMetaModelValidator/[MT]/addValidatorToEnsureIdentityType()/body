{
  MetaModelValidatorVisiting.Visitor ensureIdentityType=new MetaModelValidatorVisiting.Visitor(){
    @Override public boolean visit(    ObjectSpecification objSpec,    ValidationFailures validationFailures){
      final JdoPersistenceCapableFacet jpcf=objSpec.getFacet(JdoPersistenceCapableFacet.class);
      if (jpcf == null) {
        return true;
      }
      final IdentityType identityType=jpcf.getIdentityType();
      if (identityType != IdentityType.DATASTORE && identityType != IdentityType.UNSPECIFIED) {
        validationFailures.add("DataNucleus object store: %s must be annotated with @PersistenceCapable, with an identityType of either DATASTORE or UNSPECIFIED (has an identityType of %s)",objSpec.getFullIdentifier(),identityType);
      }
      return true;
    }
  }
;
  add(new MetaModelValidatorVisiting(ensureIdentityType));
}
