{
  final String sql="SELECT * FROM " + userTable + " WHERE UPPER("+ userNameField+ ") = ?";
  addToQueryValues(user.toUpperCase());
  final ResultSet results=select(sql);
  try {
    while (results.next()) {
      final String dbPassword=results.getString(passwordField);
      if (verifyPasswordsAreEqual(password,dbPassword)) {
        return postProcessLogin(user,password,results);
      }
    }
  }
 catch (  final SQLException e) {
    LOG.error("Error loading user details: " + sql);
    throw new ApplicationException("Error loading user details",e);
  }
  return null;
}
