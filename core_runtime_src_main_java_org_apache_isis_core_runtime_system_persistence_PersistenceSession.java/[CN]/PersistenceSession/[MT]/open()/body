{
  ensureNotOpened();
  if (LOG.isDebugEnabled()) {
    LOG.debug("opening " + this);
  }
  servicesInjector.injectInto(objectFactory);
  servicesInjector.injectInto(adapterManager);
  adapterManager.open();
  persistenceManager=applicationComponents.getPersistenceManagerFactory().getPersistenceManager();
  final IsisLifecycleListener isisLifecycleListener=new IsisLifecycleListener(this,frameworkSynchronizer);
  persistenceManager.addInstanceLifecycleListener(isisLifecycleListener,(Class[])null);
  persistenceQueryProcessorByClass.put(PersistenceQueryFindAllInstances.class,new PersistenceQueryFindAllInstancesProcessor(this,persistenceManager));
  persistenceQueryProcessorByClass.put(PersistenceQueryFindUsingApplibQueryDefault.class,new PersistenceQueryFindUsingApplibQueryProcessor(this,persistenceManager));
  initServices();
  setState(State.OPEN);
}
