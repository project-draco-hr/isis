{
  final ObjectAdapter objectAdapter=adapterFor(pojo);
  final ObjectAdapter adapter=objectAdapter;
  final RootOid rootOid=(RootOid)adapter.getOid();
  if (rootOid.isTransient()) {
    final RootOid persistentOid=createPersistentOrViewModelOid(pojo);
    remapAsPersistent(adapter,persistentOid);
    CallbackFacet.Util.callCallback(adapter,PersistedCallbackFacet.class);
    postLifecycleEventIfRequired(adapter,PersistedLifecycleEventFacet.class);
    final EnlistedObjectsServiceInternal enlistedObjectsServiceInternal=getServicesInjector().lookupService(EnlistedObjectsServiceInternal.class);
    enlistedObjectsServiceInternal.enlistCreated(adapter);
  }
 else {
    CallbackFacet.Util.callCallback(adapter,UpdatedCallbackFacet.class);
    postLifecycleEventIfRequired(adapter,UpdatedLifecycleEventFacet.class);
  }
  Version versionIfAny=getVersionIfAny(pojo);
  adapter.setVersion(versionIfAny);
}
