{
  final ObjectAdapter objectAdapter=adapterFor(pojo);
  final ObjectAdapter adapter=objectAdapter;
  final RootOid rootOid=(RootOid)adapter.getOid();
  if (rootOid.isTransient()) {
    final RootOid persistentOid=createPersistentOrViewModelOid(pojo);
    remapAsPersistent(adapter,persistentOid);
    CallbackFacet.Util.callCallback(adapter,PersistedCallbackFacet.class);
    postEvent(new ObjectPersistedEvent.Default(),pojo);
    final IsisTransaction transaction=getCurrentTransaction();
    transaction.enlistCreated(adapter);
  }
 else {
    CallbackFacet.Util.callCallback(adapter,UpdatedCallbackFacet.class);
    postEvent(new ObjectUpdatedEvent.Default(),pojo);
  }
  Version versionIfAny=getVersionIfAny(pojo);
  adapter.setVersion(versionIfAny);
}
