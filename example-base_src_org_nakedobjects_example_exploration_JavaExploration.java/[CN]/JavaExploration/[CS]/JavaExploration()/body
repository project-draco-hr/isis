{
  ConfigurationPropertiesLoader loadedProperties=new ConfigurationPropertiesLoader("log4j.properties",false);
  Properties p=loadedProperties.getProperties();
  if (p.size() == 0) {
    BasicConfigurator.configure();
  }
 else {
    PropertyConfigurator.configure(p);
  }
  Logger.getRootLogger().setLevel(Level.WARN);
  splash=null;
  try {
    String name=this.getClass().getName();
    name=name.substring(name.lastIndexOf('.') + 1);
    Configuration configuration=new Configuration(new ConfigurationPropertiesLoader(DEFAULT_CONFIG,false));
    NakedObjects.setConfiguration(configuration);
    ConfigurationFactory.setConfiguration(configuration);
    if (configuration.getString(SHOW_EXPLORATION_OPTIONS) == null) {
      configuration.add(SHOW_EXPLORATION_OPTIONS,"yes");
    }
    PropertyConfigurator.configure(ConfigurationFactory.getConfiguration().getProperties("log4j"));
    Logger log=Logger.getLogger("Naked Objects");
    log.info(AboutNakedObjects.getName());
    log.info(AboutNakedObjects.getVersion());
    log.info(AboutNakedObjects.getBuildId());
    boolean noSplash=ConfigurationFactory.getConfiguration().getBoolean("nosplash",false);
    if (!noSplash) {
      splash=new SplashWindow();
    }
    setUpLocale();
    JavaBusinessObjectContainer container=new JavaBusinessObjectContainer();
    LoadedObjectsHashtable loadedObjectsHashtable=new LoadedObjectsHashtable();
    JavaObjectFactory objectFactory=new JavaObjectFactory();
    objectFactory.setContainer(container);
    container.setObjectFactory(objectFactory);
    TransientObjectStore objectStore=new TransientObjectStore();
    objectStore.setLoadedObjects(loadedObjectsHashtable);
    OidGenerator oidGenerator=new SimpleOidGenerator();
    objectManager=new LocalObjectManager();
    objectManager.setObjectStore(objectStore);
    objectManager.setObjectFactory(objectFactory);
    objectManager.setOidGenerator(oidGenerator);
    objectManager.setLoadedObjects(loadedObjectsHashtable);
    NakedObjects.setObjectManager(objectManager);
    container.setObjectManger(objectManager);
    NakedObjectSpecificationLoaderImpl specificationLoader=new NakedObjectSpecificationLoaderImpl();
    NakedObjects.setSpecificationLoader(specificationLoader);
    LocalReflectionFactory reflectionFactory=new LocalReflectionFactory();
    JavaReflectorFactory reflectorFactory=new JavaReflectorFactory();
    PojoAdapterFactory pojoAdapterFactory=new PojoAdapterFactory();
    pojoAdapterFactory.setPojoAdapterHash(new PojoAdapterHashImpl());
    pojoAdapterFactory.setReflectorFactory(reflectorFactory);
    NakedObjects.setPojoAdapterFactory(pojoAdapterFactory);
    NakedObjectSpecificationImpl.setReflectionFactory(reflectionFactory);
    specificationLoader.setReflectorFactory(reflectorFactory);
    reflectorFactory.setObjectFactory(objectFactory);
    try {
      objectManager.init();
    }
 catch (    StartupException e) {
      throw new NakedObjectRuntimeException(e);
    }
    builder=new JavaFixtureBuilder();
  }
  finally {
    if (splash != null) {
      splash.removeAfterDelay(4);
    }
  }
}
