{
  if (persistenceMechanismInstaller == null) {
    final String persistenceMechanism=getConfiguration().getString(SystemConstants.OBJECT_PERSISTOR_INSTALLER_KEY);
    persistenceMechanismInstaller=installerLookup.persistenceMechanismInstaller(persistenceMechanism,deploymentType);
  }
  ensureThatState(persistenceMechanismInstaller,is(not(nullValue())),"persistor installer has not been injected and could not be looked up");
  return persistenceMechanismInstaller.createPersistenceSessionFactory(deploymentType);
}
