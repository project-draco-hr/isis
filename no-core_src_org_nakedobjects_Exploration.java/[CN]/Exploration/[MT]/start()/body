{
  loadConfiguration();
  showSplash();
  setUpLocale();
  clock=new ExplorationClock();
  Date.setClock(clock);
  Time.setClock(clock);
  TimeStamp.setClock(clock);
  NakedObjectStore objectStore=(NakedObjectStore)ComponentLoader.loadComponent(OBJECT_STORE,TransientObjectStore.class,NakedObjectStore.class);
  ObjectViewingMechanism viewer=(ObjectViewingMechanism)ComponentLoader.loadComponent(VIEWING_MECHANISM,ObjectViewingMechanism.class);
  objectManager=new LocalObjectManager(objectStore,viewer.getUpdateNotifier());
  try {
    objectManager.init();
    User user=setUpUsers();
    setUpExploration();
    SecurityContext context=new SecurityContext(null,user);
    NakedObject rootObject=user.getRootObject();
    if (rootObject == null) {
      LOG.warn("User had no root context, a default one has been assigned");
      rootObject=new DefaultUserContext();
      rootObject.created();
      objectManager.makePersistent(rootObject);
      user.setRootObject(rootObject);
      ((DefaultUserContext)rootObject).setUser(user);
    }
    String name=this.getClass().getName();
    name=name.substring(name.lastIndexOf('.') + 1);
    viewer.setTitle(name);
    viewer.init(rootObject);
    viewer.start();
  }
 catch (  StartupException e) {
    if (objectStore == null) {
      try {
        objectStore.shutdown();
      }
 catch (      ObjectStoreException e1) {
        e1.printStackTrace();
      }
    }
    if (objectManager == null) {
      objectManager.shutdown();
    }
    throw e;
  }
}
