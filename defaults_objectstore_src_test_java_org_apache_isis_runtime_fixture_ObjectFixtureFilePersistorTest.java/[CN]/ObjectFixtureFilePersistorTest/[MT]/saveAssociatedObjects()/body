{
  Set<Object> objects=new AbstractSet<Object>(){
    public Iterator<Object> iterator(){
      List<Object> list=new ArrayList<Object>();
      Movie movie=new Movie();
      movie.setName("The Blockbuster");
      movie.setDirector(person);
      list.add(movie);
      list.add(person);
      return list.iterator();
    }
    public int size(){
      return 2;
    }
  }
;
  StringWriter out=new StringWriter();
  persistor.save(objects,out);
  String string1="org.apache.isis.runtime.testdomain.Movie#2\n  director: org.apache.isis.runtime.testdomain.Person#3\n  name: The Blockbuster\n  roles: \n" + "org.apache.isis.runtime.testdomain.Person#3\n  date: 08-Mar-2010 00:00\n  name: Fred Smith\n";
  String string2="org.apache.isis.runtime.testdomain.Movie#2\r\n  director: org.apache.isis.runtime.testdomain.Person#3\r\n  name: The Blockbuster\r\n  roles: \r\n" + "org.apache.isis.runtime.testdomain.Person#3\r\n  date: 08-Mar-2010 00:00\r\n  name: Fred Smith\r\n";
  if ((out.toString().compareTo(string1) != 0) && (out.toString().compareTo(string2) != 0)) {
    Assert.assertEquals(string1,out.toString());
  }
}
