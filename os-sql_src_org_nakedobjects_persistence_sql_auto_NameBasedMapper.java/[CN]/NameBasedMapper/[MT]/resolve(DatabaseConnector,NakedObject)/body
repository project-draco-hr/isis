{
  NakedObjectSpecification cls=object.getSpecification();
  String table=table(cls);
  String columns=columns(cls);
  String id=primaryKey(object.getOid());
  LOG.debug("loading data from SQL " + table + " for "+ object);
  String statement="select " + columns + " from "+ table+ " where id = "+ id;
  Results rs=connector.select(statement);
  if (rs.next()) {
    FieldSpecification[] fields=cls.getFields();
    for (int i=0; i < fields.length; i++) {
      if (fields[i].isDerived()) {
        continue;
      }
 else       if (fields[i] instanceof OneToManyAssociationSpecification) {
        DatabaseConnector connection=connector.getConnectionPool().acquire();
        loadInternalCollection(connection,id,fields[i],(InternalCollection)fields[i].get(object));
        connector.getConnectionPool().release(connection);
      }
 else       if (fields[i] instanceof ValueFieldSpecification) {
        ValueMapper mapper=ValueMapperLookup.getInstance().mapperFor(fields[i].getSpecification());
        mapper.setFromDBColumn(columnName(fields[i]),fields[i],object,rs);
      }
 else       if (fields[i] instanceof OneToOneAssociationSpecification) {
        NakedObjectSpecification associatedCls=fields[i].getSpecification();
        NakedObject reference=setupReference(loadedObjects,associatedCls,rs.getInt(columnName(fields[i])));
        object.setAssociation((AssociationSpecification)fields[i],reference);
      }
    }
    object.setResolved();
    rs.close();
  }
 else {
    rs.close();
    throw new SqlObjectStoreException("Unable to load data for " + id + " from "+ table);
  }
}
