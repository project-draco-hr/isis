{
  final String serviceHost=config.getString("fileserver.sync-host",DEFAULT_HOST);
  final int servicePort=config.getInt("fileserver.sync-port",DEFAULT_SYNC_PORT);
  Util.ensureDirectoryExists();
  ServerSocket socket=null;
  try {
    LOG.debug("setting up syncing socket on " + serviceHost + ":"+ servicePort);
    final InetAddress address=InetAddress.getByName(serviceHost);
    socket=new ServerSocket(servicePort,0,address);
    LOG.info("listenting on " + socket.getInetAddress().getHostAddress() + " port "+ socket.getLocalPort());
    LOG.debug("listenting on " + socket);
    do {
      syncConnection(socket.accept(),0);
    }
 while (awaitConnections);
  }
 catch (  final UnknownHostException e) {
    LOG.error("Unknown host " + serviceHost,e);
    System.exit(0);
  }
catch (  final IOException e) {
    LOG.error("start failure - networking not set up for " + serviceHost,e);
    System.exit(0);
  }
catch (  final RuntimeException e) {
    LOG.error("start failure",e);
    System.exit(0);
  }
}
