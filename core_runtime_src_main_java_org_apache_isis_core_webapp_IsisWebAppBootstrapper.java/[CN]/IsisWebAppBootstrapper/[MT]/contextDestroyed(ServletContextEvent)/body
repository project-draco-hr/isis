{
  LOG.info("server shutting down");
  final ServletContext servletContext=ev.getServletContext();
  try {
    final IsisSystem isisSystem=(IsisSystem)servletContext.getAttribute(WebAppConstants.ISIS_SYSTEM_KEY);
    if (isisSystem != null) {
      LOG.info("calling system shutdown");
      isisSystem.getSessionFactory().destroyServicesAndShutdown();
    }
  }
  finally {
    servletContext.removeAttribute(WebAppConstants.ISIS_SYSTEM_KEY);
    LOG.info("server shut down");
  }
}
