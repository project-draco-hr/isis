{
  char c;
  boolean isSpace=false;
  int first;
  for (first=start; ; ) {
    if (finish <= start) {
      if (isSpace)       handler.ignorableWhitespace(buf,first,start - first);
      fillbuf();
      first=start;
    }
    if (finish <= start)     return isSpace;
    c=buf[start++];
switch (c) {
case '\n':
      if (!isInternal())       lineNumber++;
case 0x09:
case 0x20:
    isSpace=true;
  continue;
case '\r':
isSpace=true;
if (!isInternal()) lineNumber++;
handler.ignorableWhitespace(buf,first,(start - 1) - first);
handler.ignorableWhitespace(newline,0,1);
if (start < finish && buf[start] == '\n') ++start;
first=start;
continue;
default :
ungetc();
if (isSpace) handler.ignorableWhitespace(buf,first,start - first);
return isSpace;
}
}
}
