{
  int numberParameters=action.getParameterTypes().length;
  Naked[] parameters=new Naked[numberParameters];
  Naked[][] parameterOptions=new Naked[numberParameters][];
  ActionParameterSet parameterHints=target.getParameters(action);
  Object[] defaultValues;
  Object[][] options;
  String[] labels;
  boolean[] required;
  if (parameterHints != null) {
    labels=parameterHints.getParameterLabels();
    defaultValues=parameterHints.getDefaultParameterValues();
    options=parameterHints.getOptions();
    required=parameterHints.getRequiredParameters();
  }
 else {
    labels=new String[numberParameters];
    defaultValues=new Naked[numberParameters];
    options=new Naked[numberParameters][0];
    required=new boolean[numberParameters];
  }
  Naked[] values;
  NakedObjectSpecification[] parameterTypes;
  parameterTypes=action.getParameterTypes();
  values=new Naked[parameterTypes.length];
  for (int i=0; i < parameterTypes.length; i++) {
    if (parameterTypes[i].isValue()) {
      values[i]=NakedObjects.getObjectLoader().createValueInstance(parameterTypes[i]);
    }
 else {
      values[i]=null;
    }
  }
  Naked[] parameterValues;
  parameterValues=new Naked[parameterTypes.length];
  for (int i=0; i < parameterValues.length; i++) {
    parameterValues[i]=values[i];
  }
  for (int i=0; i < numberParameters; i++) {
    NakedObjectSpecification type=parameterTypes[i];
    labels[i]=labels[i] == null ? type.getShortName() : labels[i];
    if (defaultValues[i] == null) {
      parameters[i]=parameterValues[i];
    }
 else {
      parameters[i]=NakedObjects.getObjectLoader().createAdapterForValue(defaultValues[i]);
      if (parameters[i] == null) {
        parameters[i]=NakedObjects.getObjectLoader().getAdapterForElseCreateAdapterForTransient(defaultValues[i]);
      }
    }
    if (options[i] != null) {
      parameterOptions[i]=new NakedObject[options[i].length];
      for (int j=0; j < parameterOptions[i].length; j++) {
        parameterOptions[i][j]=NakedObjects.getObjectLoader().createAdapterForValue(options[i][j]);
        if (parameterOptions[i][j] == null) {
          parameterOptions[i][j]=NakedObjects.getObjectLoader().getAdapterForElseCreateAdapterForTransient(options[i][j]);
        }
      }
    }
  }
  return new ActionHelper(target,action,labels,parameters,parameterTypes,required,parameterOptions);
}
