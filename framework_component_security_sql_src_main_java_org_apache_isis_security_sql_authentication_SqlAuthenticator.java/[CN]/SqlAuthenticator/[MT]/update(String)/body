{
  LOG.debug("SQL: " + sql);
  PreparedStatement statement;
  try {
    statement=connection.prepareStatement(sql);
    addPreparedValues(statement);
    final int updateCount=statement.executeUpdate();
    statement.close();
    return updateCount;
  }
 catch (  final SQLException e) {
    LOG.error("failed to execute " + sql,e);
    throw new ApplicationException("Error executing update",e);
  }
 finally {
    clearPreparedValues();
  }
}
