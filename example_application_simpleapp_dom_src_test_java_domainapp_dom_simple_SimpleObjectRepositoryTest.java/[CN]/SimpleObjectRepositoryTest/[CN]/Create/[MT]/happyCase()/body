{
  final SimpleObject simpleObject=new SimpleObject();
  final Sequence seq=context.sequence("create");
  context.checking(new Expectations(){
{
      oneOf(mockRepositoryService).instantiate(SimpleObject.class);
      inSequence(seq);
      will(returnValue(simpleObject));
      oneOf(mockRepositoryService).persist(simpleObject);
      inSequence(seq);
    }
  }
);
  final SimpleObject obj=simpleObjectRepository.create("Foobar");
  assertThat(obj).isEqualTo(simpleObject);
  assertThat(obj.getName()).isEqualTo("Foobar");
}
