{
  if (field == null) {
    writer.writeField(association.getId(),null);
  }
 else   if (field.getOid() instanceof AggregatedOid) {
    final String specName=field.getSpecification().getFullIdentifier();
    final StateWriter aggregateWriter=writer.addAggregate(association.getId());
    aggregateWriter.writeId(((AggregatedOid)field.getOid()).getId());
    writeFields(aggregateWriter,specName,field);
  }
 else {
    throw new NoSqlStoreException("Object type is inconsistent with it OID - it should have an AggregatedOid: " + field);
  }
}
