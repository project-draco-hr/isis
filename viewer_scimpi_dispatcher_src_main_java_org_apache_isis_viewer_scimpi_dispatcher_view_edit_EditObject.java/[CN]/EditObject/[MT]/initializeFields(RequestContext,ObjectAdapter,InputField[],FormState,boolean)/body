{
  for (int i=0; i < formFields.length; i++) {
    String fieldId=formFields[i].getName();
    ObjectAssociation field=object.getSpecification().getAssociation(fieldId);
    InputField formField=formFields[i];
    AuthenticationSession session=IsisContext.getAuthenticationSession();
    Consent usable=field.isUsable(session,object);
    ObjectAdapter[] options=field.getChoices(object);
    FieldFactory.initializeField(context,object,field,options,field.isMandatory(),formField);
    boolean isEditable=usable.isAllowed();
    if (!isEditable) {
      formField.setDescription(usable.getReason());
    }
    formField.setEditable(isEditable);
    boolean notVisible=field.isVisible(session,object).isVetoed() || (!includeUnusableFields && usable.isAllowed());
    if (notVisible) {
      formField.setHidden(true);
    }
  }
}
