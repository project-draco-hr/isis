{
  Object[] fieldContent=data.getFieldContent();
  if (fieldContent != null && fieldContent.length > 0) {
    NakedObjectField[] fields=object.getSpecification().getFields();
    for (int i=0; i < fields.length; i++) {
      if (fieldContent[i] instanceof NullData && !completeData) {
        LOG.debug("no data for field " + fields[i].getName());
        continue;
      }
      if (fields[i].isCollection()) {
        if (fieldContent[i] != null) {
          CollectionData collection=(CollectionData)fieldContent[i];
          int size=collection.getElements().length;
          if (completeData || size > 0) {
            NakedObject[] elements=new NakedObject[size];
            for (int j=0; j < elements.length; j++) {
              elements[j]=restoreObject(((ObjectData)collection.getElements()[j]));
              LOG.debug("adding element to " + fields[i].getName() + ": "+ elements[j]);
            }
            object.initAssociation((OneToManyAssociation)fields[i],elements);
          }
        }
      }
 else       if (fields[i].isValue()) {
        if (fieldContent[i] != null) {
          LOG.debug("setting value for field " + fields[i].getName() + ": "+ fieldContent[i]);
          object.initValue((OneToOneAssociation)fields[i],fieldContent[i] instanceof NullData ? null : ((ValueData)fieldContent[i]).getValue());
        }
      }
 else {
        if (fieldContent[i] != null) {
          NakedObjectAssociation field=(NakedObjectAssociation)fields[i];
          NakedObject associate;
          if (fieldContent[i] instanceof NullData) {
            associate=null;
          }
 else {
            associate=restoreObject((ObjectData)fieldContent[i]);
          }
          LOG.debug("setting association for field " + fields[i].getName() + ": "+ associate);
          object.initAssociation(field,associate);
        }
      }
    }
  }
}
