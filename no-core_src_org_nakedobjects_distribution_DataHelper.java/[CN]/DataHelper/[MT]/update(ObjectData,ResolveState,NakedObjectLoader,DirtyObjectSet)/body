{
  Oid oid=data.getOid();
  Object[] fieldContent=data.getFieldContent();
  long version=data.getVersion();
  NakedObject object;
  object=objectLoader.getAdapterFor(oid);
  object.setOptimisticLock(version,"",null);
  objectLoader.start(object,initialState);
  NakedObjectField[] fields=object.getSpecification().getFields();
  if (fields.length > 0) {
    for (int i=0; i < fields.length; i++) {
      if (fields[i].isCollection()) {
        CollectionData collection=(CollectionData)fieldContent[i];
        Object[] elements=collection.getElements();
        NakedObject[] instances=new NakedObject[elements.length];
        for (int j=0; j < instances.length; j++) {
          ObjectData objectData=(ObjectData)elements[j];
          instances[j]=recreateObject(objectData);
        }
        object.initOneToManyAssociation((OneToManyAssociation)fields[i],instances);
      }
 else       if (fields[i].isValue()) {
        object.initValue((OneToOneAssociation)fields[i],((ValueData)fieldContent[i]).getValue());
      }
 else {
        NakedObject field;
        if (fieldContent[i] instanceof NullData) {
          field=null;
        }
 else {
          field=recreateObject((ObjectData)fieldContent[i]);
        }
        object.initAssociation((NakedObjectAssociation)fields[i],field);
      }
    }
  }
  objectLoader.end(object);
  updateNotifier.addDirty(object);
}
