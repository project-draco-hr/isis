{
  startNewFileIfNeeded();
  try {
    writer.write(("#transaction started - " + new Date().toString() + "\n").getBytes());
    for (    final FileContent content : items) {
      writer.write(content.command);
      content.write(writer);
      writer.write('\n');
    }
    writer.write("#transaction ended\n\n".getBytes());
    writer.flush();
  }
 catch (  final IOException e) {
    throw new NoSqlStoreException("Failed to write data to log file",e);
  }
}
