{
  ObjectAdapter object=inObject;
  Oid oid=object.getOid();
  if (oidType == null) {
    oidType=oid.getClass();
  }
  String encodedOid;
  if (oid instanceof AggregatedOid) {
    AggregatedOid aoid=(AggregatedOid)oid;
    Oid parentOid=aoid.getParentOid();
    object=IsisContext.getPersistenceSession().getAdapterManager().getAdapterFor(parentOid);
  }
  encodedOid=encodedOid(oid);
  boolean isTransient=object.isTransient();
  String id=(isTransient ? "T" : "P") + object.getSpecification().getFullIdentifier() + "@"+ encodedOid;
  LOG.debug("encoded " + oid + " as "+ id+ " ~ "+ encodedOid);
  if (isTransient) {
    TransientObjectMapping mapping=new TransientObjectMapping((ObjectAdapter)inObject);
    if (scope == Scope.REQUEST) {
      requestTransients.put(id,mapping);
    }
 else     if (scope == Scope.INTERACTION || scope == Scope.SESSION) {
      sessionTransients.put(id,mapping);
    }
 else {
      throw new ScimpiException("Can't hold globally transient object");
    }
  }
  return id;
}
