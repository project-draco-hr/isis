{
  int width=coreSize.getWidth();
  int height=coreSize.getHeight();
  canvas.drawSolidRectangle(0,0,width,height,backgroundColor);
  canvas.draw3DRectangle(0,0,width,height,backgroundColor,true);
  int itemHeight=style().getLineHeight() + VPADDING;
  int baseLine=itemHeight / 2 + style().getAscent() / 2 + getPadding().getTop();
  int left=getPadding().getLeft();
  for (int i=0; i < items.length; i++) {
    if (items[i].isBlank) {
      int y=baseLine - (style().getAscent() / 2);
      canvas.drawLine(1,y,width - 2,y,backgroundColor.brighter());
      canvas.drawLine(1,y - 1,width - 2,y - 1,backgroundColor.darker());
    }
 else {
      Color color;
      if (items[i].isDisabled || items[i].action == null) {
        color=disabledColor();
      }
 else       if (getOption() == i) {
        int top=getPadding().getTop() + i * itemHeight;
        int depth=style().getLineHeight() + 2;
        canvas.drawSolidRectangle(2,top,width - 4,depth,backgroundColor.darker());
        color=reversedColor();
      }
 else {
        color=normalColor();
      }
      canvas.drawText(items[i].name,left,baseLine,color,style());
      if (items[i].action instanceof UserActionSet) {
        Shape arrow;
        arrow=new Shape(0,0);
        arrow.extendsLine(4,4);
        arrow.extendsLine(-4,4);
        canvas.drawSolidShape(arrow,width - 10,baseLine - 8,color);
      }
    }
    baseLine+=itemHeight;
  }
  Canvas submenuCanvas=canvas.createSubcanvas(submenu.getBounds());
  LOG.debug(submenu.getBounds());
  submenu.draw(submenuCanvas);
}
