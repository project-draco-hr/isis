{
  final EntityModel entityModel=getEntityModel();
  final ObjectAdapter adapter=Generics.coalesce(getPendingAdapter(),entityModel.getObject());
  final IModel<List<? extends ObjectAdapterMemento>> choicesMementos=getChoicesModel();
  if (choicesMementos != null) {
    final IModel<ObjectAdapterMemento> modelObject=entityOidField.getModel();
    final DropDownChoicesForObjectAdapterMementos dropDownChoices=new DropDownChoicesForObjectAdapterMementos(ID_CHOICES,modelObject,choicesMementos);
    addOrReplace(dropDownChoices);
    dropDownChoices.setEnabled(getEntityModel().isEditMode());
    permanentlyHide(ID_ENTITY_LINK_WRAPPER);
    permanentlyHide(ID_ENTITY_TITLE_NULL);
  }
 else {
    permanentlyHide(ID_CHOICES);
    syncLinkWithInput(adapter);
    syncEntityTitleNullWithInput(adapter);
  }
  syncEntityDetailsButtonWithInput(adapter);
  syncEntityDetailsWithInput(adapter);
  syncFindUsingAndEntityDetailsLinkVisibility();
}
