{
  final PageParameters pageParameters=EntityModel.createPageParameters(adapter);
  final Class<? extends Page> pageClass=getPageClassRegistry().getPageClass(PageType.ENTITY);
  final AbstractLink link=newLink(ID_ENTITY_LINK,pageClass,pageParameters);
  label=new Label(ID_ENTITY_TITLE,adapter.titleString());
  link.add(label);
  final PackageResource imageResource=determineImageResource(adapter);
  if (imageResource != null) {
    image=new Image(ID_ENTITY_ICON,imageResource);
    link.addOrReplace(image);
  }
 else {
    permanentlyHide(ID_ENTITY_ICON);
  }
  final WebMarkupContainer entityLinkWrapper=new WebMarkupContainer(ID_ENTITY_LINK_WRAPPER);
  entityLinkWrapper.addOrReplace(link);
  entityLinkWrapper.setEnabled(true);
  addOrReplace(entityLinkWrapper);
}
