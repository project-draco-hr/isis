{
  Connection connection=null;
  String query="select id from id_sequence";
  try {
    connection=DriverManager.getConnection("jdbc:mysql://localhost:3306/movies","rcm","rcm");
    Statement s=connection.createStatement();
    ResultSet rs=s.executeQuery(query);
    if (rs.next()) {
      id=rs.getInt(1);
    }
 else {
      id=0;
    }
    rs.close();
    s.close();
    lastInBlock=id + blockSize;
    PreparedStatement s2;
    if (id == 0) {
      s2=connection.prepareStatement("insert into id_sequence values(?)");
    }
 else {
      s2=connection.prepareStatement("update id_sequence set id =  ?");
    }
    s2.setInt(1,lastInBlock);
    s2.execute();
    s2.close();
  }
 catch (  SQLException e) {
    throw new ObjectStoreException("Failed to initialise id sequence",e);
  }
 finally {
    if (connection != null) {
      try {
        connection.close();
      }
 catch (      SQLException e) {
        throw new ObjectStoreException("Failed to close connection",e);
      }
    }
  }
}
