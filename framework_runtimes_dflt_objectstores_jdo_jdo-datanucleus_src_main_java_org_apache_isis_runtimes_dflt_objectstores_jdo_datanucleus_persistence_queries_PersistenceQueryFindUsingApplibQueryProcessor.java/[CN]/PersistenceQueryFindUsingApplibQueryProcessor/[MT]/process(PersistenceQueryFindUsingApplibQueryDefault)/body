{
  final String queryName=persistenceQuery.getQueryName();
  final Map<String,Object> map=unwrap(persistenceQuery.getArgumentsAdaptersByParameterName());
  final QueryCardinality cardinality=persistenceQuery.getCardinality();
  final ObjectSpecification objectSpec=persistenceQuery.getSpecification();
  final List<?> results;
  if ((objectSpec.getFullIdentifier() + "#pk").equals(queryName)) {
    final Class<?> cls=objectSpec.getCorrespondingClass();
    if (!JdoPropertyUtils.hasPrimaryKeyProperty(objectSpec)) {
      throw new UnsupportedOperationException("cannot search by primary key for DataStore-assigned entities");
    }
    final OneToOneAssociation pkOtoa=JdoPropertyUtils.getPrimaryKeyPropertyFor(objectSpec);
    String pkOtoaId=pkOtoa.getId();
    final String filter=pkOtoaId + "==" + map.get(pkOtoaId);
    final Query jdoQuery=getPersistenceManager().newQuery(cls,filter);
    results=(List<?>)jdoQuery.execute();
  }
 else {
    results=getResults(objectSpec,queryName,map,cardinality);
  }
  return loadAdapters(objectSpec,results);
}
