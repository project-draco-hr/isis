{
  final int length=name.length();
  final StringBuffer convertedName=new StringBuffer(length);
  boolean lastWasLowerCase=false;
  for (int i=0; i < length; i++) {
    final char ch=name.charAt(i);
    if (Character.isUpperCase(ch)) {
      if (lastWasLowerCase) {
        convertedName.append('_');
      }
      lastWasLowerCase=false;
    }
 else {
      lastWasLowerCase=true;
    }
    convertedName.append(ch);
  }
  return sqlName(convertedName.toString());
}
