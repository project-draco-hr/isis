{
  String view=request.getOptionalProperty(VIEW,request.getViewPath());
  view=request.getContext().fullFilePath(view);
  final org.apache.log4j.Level level=org.apache.log4j.LogManager.getRootLogger().getLevel();
  final boolean showSelector=request.isRequested(SHOW_SELECT,true);
  if (showSelector) {
    request.appendHtml("<form action=\"log.app\" type=\"post\" >");
    request.appendHtml("<input type=\"hidden\" name=\"view\" value=\"" + view + "\" />");
    request.appendHtml("<select name=\"level\">");
    for (    final org.apache.log4j.Level l : new org.apache.log4j.Level[]{org.apache.log4j.Level.OFF,org.apache.log4j.Level.FATAL,org.apache.log4j.Level.ERROR,org.apache.log4j.Level.WARN,org.apache.log4j.Level.INFO,org.apache.log4j.Level.DEBUG,org.apache.log4j.Level.TRACE}) {
      final String settings=level + "\"" + (level == l ? " selected=\"selected\" " : "");
      request.appendHtml("<option " + settings + ">"+ l+ "</option>");
    }
    request.appendHtml("<input type=\"submit\" value=\"Change Level\" />");
    request.appendHtml("</select>");
    request.appendHtml("</form>");
  }
 else {
    request.appendHtml(level.toString());
  }
}
