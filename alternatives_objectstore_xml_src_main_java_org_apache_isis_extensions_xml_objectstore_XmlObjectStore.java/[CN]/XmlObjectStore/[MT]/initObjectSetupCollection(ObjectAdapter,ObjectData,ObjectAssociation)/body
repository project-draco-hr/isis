{
  final ReferenceVector refs=(ReferenceVector)data.get(field.getId());
  final ObjectAdapter collection=field.get(object);
  if (collection.getResolveState().canChangeTo(ResolveState.RESOLVING)) {
    PersistorUtil.start(collection,ResolveState.RESOLVING);
    final int size=refs == null ? 0 : refs.size();
    final ObjectAdapter[] elements=new ObjectAdapter[size];
    for (int j=0; j < size; j++) {
      final SerialOid elementOid=refs.elementAt(j);
      ObjectAdapter adapter;
      adapter=getAdapterManager().getAdapterFor(elementOid);
      if (adapter == null) {
        adapter=getObject(elementOid,null);
      }
      elements[j]=adapter;
    }
    final CollectionFacet facet=CollectionFacetUtils.getCollectionFacetFromSpec(collection);
    facet.init(collection,elements);
    PersistorUtil.end(collection);
  }
}
