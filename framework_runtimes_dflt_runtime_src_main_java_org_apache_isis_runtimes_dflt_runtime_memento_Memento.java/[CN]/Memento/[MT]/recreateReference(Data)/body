{
  final ObjectSpecification spec=getSpecificationLoader().loadSpecification(data.getClassName());
  if (data instanceof StandaloneData) {
    final StandaloneData standaloneData=(StandaloneData)data;
    return standaloneData.getAdapter();
  }
 else {
    final Oid oid=data.getOid();
    if (oid == null) {
      return null;
    }
    ObjectAdapter referencedAdapter=getHydrator().recreateAdapter(spec,oid);
    if (data instanceof ObjectData) {
      if (oid.isTransient() || spec.isParented()) {
        final ResolveState resolveState=spec.isParented() ? ResolveState.GHOST : ResolveState.TRANSIENT;
        if (referencedAdapter.getResolveState().isValidToChangeTo(resolveState)) {
          referencedAdapter.changeState(resolveState);
        }
        updateObject(referencedAdapter,data,resolveState);
      }
    }
    return referencedAdapter;
  }
}
