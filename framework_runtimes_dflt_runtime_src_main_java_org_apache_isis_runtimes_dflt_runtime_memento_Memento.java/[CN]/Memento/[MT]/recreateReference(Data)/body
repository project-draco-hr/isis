{
  if (data instanceof StandaloneData) {
    final StandaloneData standaloneData=(StandaloneData)data;
    return standaloneData.getAdapter();
  }
  Oid oid=data.getOid();
  Assert.assertTrue("can only create a reference to an entity",oid instanceof TypedOid);
  final TypedOid typedOid=(TypedOid)oid;
  if (typedOid == null) {
    return null;
  }
  final ObjectAdapter referencedAdapter=getAdapterManager().adapterFor(typedOid);
  if (data instanceof ObjectData) {
    if (typedOid instanceof ParentedOid) {
      updateObject(referencedAdapter,data);
    }
 else     if (typedOid.isTransient()) {
      updateObject(referencedAdapter,data);
    }
  }
  return referencedAdapter;
}
