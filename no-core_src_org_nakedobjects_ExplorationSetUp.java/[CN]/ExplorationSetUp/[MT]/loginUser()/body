{
  Session.initSession();
  if (user != null) {
    NakedClass cls=NakedClassManager.getInstance().getNakedClass(User.class.getName());
    InstanceCollection coll=InstanceCollection.findInstances(cls,user);
    if (coll.size() == 0) {
      throw new NakedObjectRuntimeException("No user " + user);
    }
    User user=(User)coll.elements().nextElement();
    Session.setLoggedOn(new SecurityContext(null,user));
  }
}
